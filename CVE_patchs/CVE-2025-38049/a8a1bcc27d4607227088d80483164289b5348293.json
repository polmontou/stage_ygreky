"diff --git a/arch/x86/kernel/cpu/resctrl/rdtgroup.c b/arch/x86/kernel/cpu/resctrl/rdtgroup.c\nindex d7163b764c62..2d48db66fca8 100644\n--- a/arch/x86/kernel/cpu/resctrl/rdtgroup.c\n+++ b/arch/x86/kernel/cpu/resctrl/rdtgroup.c\n@@ -148,7 +148,8 @@ static int closid_alloc(void)\n \n \tlockdep_assert_held(&rdtgroup_mutex);\n \n-\tif (IS_ENABLED(CONFIG_RESCTRL_RMID_DEPENDS_ON_CLOSID)) {\n+\tif (IS_ENABLED(CONFIG_RESCTRL_RMID_DEPENDS_ON_CLOSID) &&\n+\t    is_llc_occupancy_enabled()) {\n \t\tcleanest_closid = resctrl_find_cleanest_closid();\n \t\tif (cleanest_closid < 0)\n \t\t\treturn cleanest_closid;"