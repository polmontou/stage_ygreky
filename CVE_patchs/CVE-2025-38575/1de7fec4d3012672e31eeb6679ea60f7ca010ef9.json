"diff --git a/fs/smb/server/auth.c b/fs/smb/server/auth.c\nindex 58380a986af5..c3baf6537fad 100644\n--- a/fs/smb/server/auth.c\n+++ b/fs/smb/server/auth.c\n@@ -1213,7 +1213,7 @@ int ksmbd_crypt_message(struct ksmbd_work *work, struct kvec *iov,\n free_sg:\n \tkfree(sg);\n free_req:\n-\tkfree(req);\n+\taead_request_free(req);\n free_ctx:\n \tksmbd_release_crypto_ctx(ctx);\n \treturn rc;"