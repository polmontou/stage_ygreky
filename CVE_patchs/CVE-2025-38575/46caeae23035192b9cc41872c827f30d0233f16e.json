"diff --git a/fs/smb/server/auth.c b/fs/smb/server/auth.c\nindex 2a5b4a96bf99..00b31cf86462 100644\n--- a/fs/smb/server/auth.c\n+++ b/fs/smb/server/auth.c\n@@ -1218,7 +1218,7 @@ int ksmbd_crypt_message(struct ksmbd_work *work, struct kvec *iov,\n free_sg:\n \tkfree(sg);\n free_req:\n-\tkfree(req);\n+\taead_request_free(req);\n free_ctx:\n \tksmbd_release_crypto_ctx(ctx);\n \treturn rc;"