"diff --git a/fs/smb/server/auth.c b/fs/smb/server/auth.c\nindex 8892177e500f..0d458742b707 100644\n--- a/fs/smb/server/auth.c\n+++ b/fs/smb/server/auth.c\n@@ -1217,7 +1217,7 @@ int ksmbd_crypt_message(struct ksmbd_work *work, struct kvec *iov,\n free_sg:\n \tkfree(sg);\n free_req:\n-\tkfree(req);\n+\taead_request_free(req);\n free_ctx:\n \tksmbd_release_crypto_ctx(ctx);\n \treturn rc;"