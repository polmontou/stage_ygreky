"diff --git a/fs/smb/server/auth.c b/fs/smb/server/auth.c\nindex 8e24a6665abd..c34b30642bfd 100644\n--- a/fs/smb/server/auth.c\n+++ b/fs/smb/server/auth.c\n@@ -1211,7 +1211,7 @@ int ksmbd_crypt_message(struct ksmbd_work *work, struct kvec *iov,\n free_sg:\n \tkfree(sg);\n free_req:\n-\tkfree(req);\n+\taead_request_free(req);\n free_ctx:\n \tksmbd_release_crypto_ctx(ctx);\n \treturn rc;"