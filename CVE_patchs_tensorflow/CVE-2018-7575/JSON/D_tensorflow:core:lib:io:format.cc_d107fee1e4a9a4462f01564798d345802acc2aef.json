"diff --git a/tensorflow/core/lib/io/format.cc b/tensorflow/core/lib/io/format.cc\nindex 64852943ad5..0c24c660a24 100644\n--- a/tensorflow/core/lib/io/format.cc\n+++ b/tensorflow/core/lib/io/format.cc\n@@ -13,6 +13,8 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n+#include <limits>\n+\n #include \"tensorflow/core/lib/io/format.h\"\n \n #include \"tensorflow/core/lib/core/coding.h\"\n@@ -84,6 +86,11 @@ Status ReadBlock(RandomAccessFile* file, const BlockHandle& handle,\n   // Read the block contents as well as the type/crc footer.\n   // See table_builder.cc for the code that built this structure.\n   size_t n = static_cast<size_t>(handle.size());\n+\n+  if (kBlockTrailerSize > std::numeric_limits<size_t>::max() - n) {\n+    return errors::DataLoss(\"handle.size() too big\");\n+  }\n+\n   char* buf = new char[n + kBlockTrailerSize];\n   StringPiece contents;\n   Status s = file->Read(handle.offset(), n + kBlockTrailerSize, &contents, buf);"