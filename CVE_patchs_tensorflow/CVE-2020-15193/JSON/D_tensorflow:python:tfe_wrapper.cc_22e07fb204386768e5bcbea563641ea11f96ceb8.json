"diff --git a/tensorflow/python/tfe_wrapper.cc b/tensorflow/python/tfe_wrapper.cc\nindex e76d9e872e4..87064f1f857 100644\n--- a/tensorflow/python/tfe_wrapper.cc\n+++ b/tensorflow/python/tfe_wrapper.cc\n@@ -1358,9 +1358,16 @@ PYBIND11_MODULE(_pywrap_tfe, m) {\n   // DLPack functions\n   m.def(\"TFE_ToDlpackCapsule\", [](py::handle& o) {\n     PyObject* eager_tensor_pyobject_ptr = o.ptr();\n-    TFE_TensorHandle* thandle = EagerTensor_Handle(eager_tensor_pyobject_ptr);\n     tensorflow::Safe_TF_StatusPtr status =\n         tensorflow::make_safe(TF_NewStatus());\n+\n+    if (!EagerTensor_CheckExact(eager_tensor_pyobject_ptr)) {\n+      status->status = tensorflow::errors::InvalidArgument(\n+          \"The argument to `to_dlpack` must be a TF tensor, not Python object\");\n+      tensorflow::MaybeRaiseRegisteredFromTFStatus(status.get());\n+    }\n+\n+    TFE_TensorHandle* thandle = EagerTensor_Handle(eager_tensor_pyobject_ptr);\n     void* dlm_ptr = tensorflow::TFE_HandleToDLPack(thandle, status.get());\n     tensorflow::MaybeRaiseRegisteredFromTFStatus(status.get());\n "