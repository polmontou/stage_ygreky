"diff --git a/tensorflow/core/kernels/string_ngrams_op.cc b/tensorflow/core/kernels/string_ngrams_op.cc\nindex 97b32c4242c..8aed2b3831a 100644\n--- a/tensorflow/core/kernels/string_ngrams_op.cc\n+++ b/tensorflow/core/kernels/string_ngrams_op.cc\n@@ -19,6 +19,7 @@ limitations under the License.\n #include \"absl/strings/ascii.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"tensorflow/core/framework/op_kernel.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n namespace text {\n@@ -60,6 +61,18 @@ class StringNGramsOp : public tensorflow::OpKernel {\n     OP_REQUIRES_OK(context, context->input(\"data_splits\", &splits));\n     const auto& splits_vec = splits->flat<SPLITS_TYPE>();\n \n+    // Validate that the splits are valid indices into data\n+    const int input_data_size = data->flat<tstring>().size();\n+    const int splits_vec_size = splits_vec.size();\n+    for (int i = 0; i < splits_vec_size; ++i) {\n+      bool valid_splits = splits_vec(i) >= 0;\n+      valid_splits = valid_splits && (splits_vec(i) <= input_data_size);\n+      OP_REQUIRES(\n+          context, valid_splits,\n+          errors::InvalidArgument(\"Invalid split value \", splits_vec(i),\n+                                  \", must be in [0,\", input_data_size, \"]\"));\n+    }\n+\n     int num_batch_items = splits_vec.size() - 1;\n     tensorflow::Tensor* ngrams_splits;\n     OP_REQUIRES_OK("