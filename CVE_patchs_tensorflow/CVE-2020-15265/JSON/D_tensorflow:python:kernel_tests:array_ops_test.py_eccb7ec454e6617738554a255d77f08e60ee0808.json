"diff --git a/tensorflow/python/kernel_tests/array_ops_test.py b/tensorflow/python/kernel_tests/array_ops_test.py\nindex 8eb5af399b4..4106ea9b166 100644\n--- a/tensorflow/python/kernel_tests/array_ops_test.py\n+++ b/tensorflow/python/kernel_tests/array_ops_test.py\n@@ -1628,6 +1628,22 @@ class QuantizeAndDequantizeTest(test_util.TensorFlowTestCase):\n                   axis=(axis - 4)))\n           self.assertAllClose(fake_quantized, expected)\n \n+  def testBadAxis(self):\n+    input_tensor = [2.5, 2.5]\n+    input_min = [0, 0]\n+    input_max = [1, 1]\n+    error_message_pattern = \"Shape must be at least rank 11 but is rank 1\"\n+    # TODO(b/171260356): Eager mode and graph mode throw different error types\n+    error = errors.InvalidArgumentError if context.executing_eagerly(\n+    ) else ValueError\n+    with self.assertRaisesRegex(error, error_message_pattern):\n+      self.evaluate(\n+          array_ops.quantize_and_dequantize_v2(\n+              input=input_tensor,\n+              input_min=input_min,\n+              input_max=input_max,\n+              axis=10))\n+\n   def testQuantizeDequantizeGrad(self):\n     shape = (2, 2)\n     max_threshold = 0"