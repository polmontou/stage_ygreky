"diff --git a/tensorflow/core/kernels/conv_grad_input_ops.h b/tensorflow/core/kernels/conv_grad_input_ops.h\nindex b5059c479e5..3d3a44390b5 100644\n--- a/tensorflow/core/kernels/conv_grad_input_ops.h\n+++ b/tensorflow/core/kernels/conv_grad_input_ops.h\n@@ -649,6 +649,11 @@ class Conv2DCustomBackpropInputOp : public OpKernel {\n         dims.batch_size == 1 ||\n         thread_work_unit_size >= min_thread_work_unit_size;\n \n+    OP_REQUIRES(\n+        context, work_unit_size > 0,\n+        errors::InvalidArgument(\"input, filter_sizes and out_backprop tensors \"\n+                                \"must all have at least 1 element\"));\n+\n     const size_t shard_size =\n         use_parallel_contraction\n             ? 1"