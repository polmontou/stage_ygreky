"diff --git a/tensorflow/core/kernels/string_ngrams_op_test.cc b/tensorflow/core/kernels/string_ngrams_op_test.cc\nindex b89de9ad16d..0d52283bd8f 100644\n--- a/tensorflow/core/kernels/string_ngrams_op_test.cc\n+++ b/tensorflow/core/kernels/string_ngrams_op_test.cc\n@@ -542,6 +542,40 @@ TEST_F(NgramKernelTest, TestEmptyInput) {\n   assert_int64_equal(expected_splits, *GetOutput(1));\n }\n \n+TEST_F(NgramKernelTest, TestNoTokens) {\n+  MakeOp(\"|\", {3}, \"L\", \"R\", -1, false);\n+  // Batch items are:\n+  // 0:\n+  // 1: \"a\"\n+  AddInputFromArray<tstring>(TensorShape({1}), {\"a\"});\n+  AddInputFromArray<int64>(TensorShape({3}), {0, 0, 1});\n+  TF_ASSERT_OK(RunOpKernel());\n+\n+  std::vector<tstring> expected_values(\n+      {\"L|L|R\", \"L|R|R\",             // no input in first split\n+       \"L|L|a\", \"L|a|R\", \"a|R|R\"});  // second split\n+  std::vector<int64> expected_splits({0, 2, 5});\n+\n+  assert_string_equal(expected_values, *GetOutput(0));\n+  assert_int64_equal(expected_splits, *GetOutput(1));\n+}\n+\n+TEST_F(NgramKernelTest, TestNoTokensNoPad) {\n+  MakeOp(\"|\", {3}, \"\", \"\", 0, false);\n+  // Batch items are:\n+  // 0:\n+  // 1: \"a\"\n+  AddInputFromArray<tstring>(TensorShape({1}), {\"a\"});\n+  AddInputFromArray<int64>(TensorShape({3}), {0, 0, 1});\n+  TF_ASSERT_OK(RunOpKernel());\n+\n+  std::vector<tstring> expected_values({});\n+  std::vector<int64> expected_splits({0, 0, 0});\n+\n+  assert_string_equal(expected_values, *GetOutput(0));\n+  assert_int64_equal(expected_splits, *GetOutput(1));\n+}\n+\n TEST_F(NgramKernelTest, ShapeFn) {\n   ShapeInferenceTestOp op(\"StringNGrams\");\n   INFER_OK(op, \"?;?\", \"[?];[?]\");"