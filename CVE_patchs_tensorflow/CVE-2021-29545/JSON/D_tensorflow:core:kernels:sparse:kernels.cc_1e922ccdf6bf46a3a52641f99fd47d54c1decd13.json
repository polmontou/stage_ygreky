"diff --git a/tensorflow/core/kernels/sparse/kernels.cc b/tensorflow/core/kernels/sparse/kernels.cc\nindex 0eea9f1feed..dff9aeb83cc 100644\n--- a/tensorflow/core/kernels/sparse/kernels.cc\n+++ b/tensorflow/core/kernels/sparse/kernels.cc\n@@ -22,6 +22,7 @@ limitations under the License.\n #include \"tensorflow/core/framework/tensor_types.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n #include \"tensorflow/core/lib/core/status.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n namespace functor {\n@@ -63,6 +64,11 @@ Status SparseTensorToCSRSparseMatrixCPUFunctor::operator()(\n \n     for (int64 i = 0; i < total_nnz; ++i) {\n       // For now, the rows pointers store the corresponding row counts.\n+      int64 ix = indices(i, 0) + 1;\n+      if (ix >= csr_row_ptr.size()) {\n+        return errors::InvalidArgument(\"Got an index \", ix,\n+                                       \" that is outside of csr_row_ptr\");\n+      }\n       csr_row_ptr(indices(i, 0) + 1) += 1;\n       csr_col_ind(i) = indices(i, 1);\n     }"