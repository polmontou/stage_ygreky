"diff --git a/tensorflow/core/kernels/sparse_fill_empty_rows_op.cc b/tensorflow/core/kernels/sparse_fill_empty_rows_op.cc\nindex a2b8b074aa1..c1ed592b965 100644\n--- a/tensorflow/core/kernels/sparse_fill_empty_rows_op.cc\n+++ b/tensorflow/core/kernels/sparse_fill_empty_rows_op.cc\n@@ -228,7 +228,10 @@ void SparseFillEmptyRowsOpImpl(OpKernelContext* context,\n                               default_value_t.shape().DebugString()),\n       done);\n   // TODO(ebrevdo): add shape checks between values, indices,\n-  // dense_shape.  Also add check that dense rank > 0.\n+  // Also add check that dense rank > 0.\n+  OP_REQUIRES_ASYNC(context, dense_shape_t.NumElements() != 0,\n+                    errors::InvalidArgument(\"Dense shape cannot be empty.\"),\n+                    done);\n \n   using FunctorType = functor::SparseFillEmptyRows<Device, T, Tindex>;\n   OP_REQUIRES_OK_ASYNC(context,"