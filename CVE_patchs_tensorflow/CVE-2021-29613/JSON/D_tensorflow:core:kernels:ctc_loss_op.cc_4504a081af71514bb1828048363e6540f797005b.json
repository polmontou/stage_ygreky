"diff --git a/tensorflow/core/kernels/ctc_loss_op.cc b/tensorflow/core/kernels/ctc_loss_op.cc\nindex 6358e82fdda..b0e298a0f32 100644\n--- a/tensorflow/core/kernels/ctc_loss_op.cc\n+++ b/tensorflow/core/kernels/ctc_loss_op.cc\n@@ -100,6 +100,10 @@ class CTCLossOp : public OpKernel {\n                 errors::InvalidArgument(\"sequence_length is not a vector\"));\n     OP_REQUIRES(ctx, TensorShapeUtils::IsMatrix(labels_indices->shape()),\n                 errors::InvalidArgument(\"labels_indices is not a matrix\"));\n+    OP_REQUIRES(ctx, labels_indices->dim_size(1) > 1,\n+                errors::InvalidArgument(\n+                    \"labels_indices second dimension must be >= 1. Received \",\n+                    labels_indices->dim_size(1)));\n     OP_REQUIRES(ctx, TensorShapeUtils::IsVector(labels_values->shape()),\n                 errors::InvalidArgument(\"labels_values is not a vector\"));\n "