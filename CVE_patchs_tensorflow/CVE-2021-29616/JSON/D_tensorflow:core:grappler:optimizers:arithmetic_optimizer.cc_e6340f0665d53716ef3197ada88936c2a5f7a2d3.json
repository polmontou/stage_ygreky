"diff --git a/tensorflow/core/grappler/optimizers/arithmetic_optimizer.cc b/tensorflow/core/grappler/optimizers/arithmetic_optimizer.cc\nindex 484983a7a54..774fdf34847 100644\n--- a/tensorflow/core/grappler/optimizers/arithmetic_optimizer.cc\n+++ b/tensorflow/core/grappler/optimizers/arithmetic_optimizer.cc\n@@ -2047,6 +2047,12 @@ class ReorderCastLikeAndValuePreserving : public ArithmeticOptimizerStage {\n \n   Status TrySimplify(NodeDef* consumer, string* simplified_node_name) override {\n     NodeDef* producer;\n+\n+    if (consumer->input_size() < 1) {\n+      return errors::FailedPrecondition(\"Node \", simplified_node_name,\n+                                        \" lacks inputs\");\n+    }\n+\n     TF_RETURN_IF_ERROR(GetInputNode(consumer->input(0), &producer));\n     const bool producer_is_cast = IsCastLike(*producer);\n     const bool can_optimize =\n@@ -2538,6 +2544,11 @@ class ReplaceMulWithSquare : public ArithmeticOptimizerStage {\n   ~ReplaceMulWithSquare() override = default;\n \n   bool IsSupported(const NodeDef* node) const override {\n+    if (!node || node->input_size() < 2) {\n+      // Invalid node\n+      return false;\n+    }\n+\n     return IsAnyMul(*node) && node->input(0) == node->input(1);\n   }\n "