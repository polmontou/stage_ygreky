"diff --git a/tensorflow/compiler/mlir/lite/transforms/optimize.cc b/tensorflow/compiler/mlir/lite/transforms/optimize.cc\nindex d457612bf70..6a8803d2461 100644\n--- a/tensorflow/compiler/mlir/lite/transforms/optimize.cc\n+++ b/tensorflow/compiler/mlir/lite/transforms/optimize.cc\n@@ -68,6 +68,9 @@ constexpr char kRelu6[] = \"RELU6\";\n constexpr char kRelu1[] = \"RELU_N1_TO_1\";\n \n bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {\n+  if (axis.getNumElements() == 0) {\n+    return false;\n+  }\n   if (sq_op.getType().cast<ShapedType>().getRank() - 1 ==\n           *axis.getValues<int>().begin() ||\n       *axis.getValues<int>().begin() == -1) {"