"diff --git a/tensorflow/core/util/image_resizer_state.h b/tensorflow/core/util/image_resizer_state.h\nindex 31764bdd879..48e51705b47 100644\n--- a/tensorflow/core/util/image_resizer_state.h\n+++ b/tensorflow/core/util/image_resizer_state.h\n@@ -143,11 +143,15 @@ struct ImageResizerState {\n   void ValidateAndCreateOutput(OpKernelContext* context) {\n     ValidateAndCalculateOutputSize(context);\n     if (!context->status().ok()) return;\n-    OP_REQUIRES_OK(\n-        context,\n-        context->allocate_output(\n-            0, TensorShape({batch_size, out_height, out_width, channels}),\n-            &output));\n+\n+    TensorShape shape;\n+    // Guard against shape overflow\n+    OP_REQUIRES_OK(context, shape.AddDimWithStatus(batch_size));\n+    OP_REQUIRES_OK(context, shape.AddDimWithStatus(out_height));\n+    OP_REQUIRES_OK(context, shape.AddDimWithStatus(out_width));\n+    OP_REQUIRES_OK(context, shape.AddDimWithStatus(channels));\n+\n+    OP_REQUIRES_OK(context, context->allocate_output(0, shape, &output));\n   }\n \n   int64_t batch_size;"