"diff --git a/tensorflow/core/kernels/linalg/einsum_op_impl.h b/tensorflow/core/kernels/linalg/einsum_op_impl.h\nindex 5c41e38954d..6f643345551 100644\n--- a/tensorflow/core/kernels/linalg/einsum_op_impl.h\n+++ b/tensorflow/core/kernels/linalg/einsum_op_impl.h\n@@ -153,6 +153,7 @@ struct EinsumHelper {\n     input_has_ellipsis->resize(num_inputs);\n     for (int i = 0; i < num_inputs; ++i) {\n       input_label_counts->at(i).resize(num_labels);\n+      input_has_ellipsis->at(i) = false;\n       for (const int label : input_labels->at(i)) {\n         if (label != kEllipsisLabel)\n           input_label_counts->at(i)[label] += 1;\n@@ -161,6 +162,7 @@ struct EinsumHelper {\n       }\n     }\n     output_label_counts->resize(num_labels);\n+    *output_has_ellipsis = false;\n     for (const int label : *output_labels) {\n       if (label != kEllipsisLabel)\n         output_label_counts->at(label) += 1;"