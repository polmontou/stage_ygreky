"diff --git a/tensorflow/core/kernels/conv_ops.cc b/tensorflow/core/kernels/conv_ops.cc\nindex 94926358675..67418151a1c 100644\n--- a/tensorflow/core/kernels/conv_ops.cc\n+++ b/tensorflow/core/kernels/conv_ops.cc\n@@ -183,12 +183,18 @@ struct LaunchGrouped {\n     auto on_shuffled = [&]() { shuffles_completed.DecrementCount(); };\n \n     // Shuffle input into temporary tensor.\n-    Tensor input_shuffled(input.dtype(), TensorShape(post_shuffle(input)));\n+    Tensor input_shuffled;\n+    OP_REQUIRES_OK(\n+        ctx, ctx->allocate_temp(input.dtype(), TensorShape(post_shuffle(input)),\n+                                &input_shuffled));\n     input_shuffled.tensor<T, 5>().device(device, on_shuffled) =\n         input.shaped<T, 5>(pre_shuffle(input)).shuffle(shuffle);\n \n     // Shuffle filter into temporary tensor.\n-    Tensor filter_shuffled(filter.dtype(), TensorShape(post_shuffle(filter)));\n+    Tensor filter_shuffled;\n+    OP_REQUIRES_OK(ctx, ctx->allocate_temp(filter.dtype(),\n+                                           TensorShape(post_shuffle(filter)),\n+                                           &filter_shuffled));\n     filter_shuffled.tensor<T, 5>().device(device, on_shuffled) =\n         filter.shaped<T, 5>(pre_shuffle(filter)).shuffle(shuffle);\n \n@@ -196,7 +202,10 @@ struct LaunchGrouped {\n     shuffles_completed.Wait();\n \n     // Write group convolution results into temporary output tensor.\n-    Tensor output_shuffled(output->dtype(), TensorShape(post_shuffle(*output)));\n+    Tensor output_shuffled;\n+    OP_REQUIRES_OK(ctx, ctx->allocate_temp(output->dtype(),\n+                                           TensorShape(post_shuffle(*output)),\n+                                           &output_shuffled));\n \n     for (int64_t i = 0; i < num_groups; ++i) {\n       // TODO(ezhulenev): Run this loop using `parallelFor` (regular parallelFor"