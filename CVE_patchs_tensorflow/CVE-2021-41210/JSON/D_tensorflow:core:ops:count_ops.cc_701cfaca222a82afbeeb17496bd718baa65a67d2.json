"diff --git a/tensorflow/core/ops/count_ops.cc b/tensorflow/core/ops/count_ops.cc\nindex 4f9631310df..aa6c0437337 100644\n--- a/tensorflow/core/ops/count_ops.cc\n+++ b/tensorflow/core/ops/count_ops.cc\n@@ -41,6 +41,8 @@ Status DenseCountSparseOutputShapeFn(InferenceContext *c) {\n }\n \n Status SparseCountSparseOutputShapeFn(InferenceContext *c) {\n+  ShapeHandle unused;\n+  TF_RETURN_IF_ERROR(c->WithRank(c->input(0), 2, &unused));\n   auto rank = c->Dim(c->input(0), 1);\n   auto nvals = c->UnknownDim();\n   c->set_output(0, c->Matrix(nvals, rank));  // out.indices"