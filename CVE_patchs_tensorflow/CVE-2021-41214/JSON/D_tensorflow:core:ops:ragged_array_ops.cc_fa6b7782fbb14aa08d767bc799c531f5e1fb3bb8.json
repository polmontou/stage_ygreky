"diff --git a/tensorflow/core/ops/ragged_array_ops.cc b/tensorflow/core/ops/ragged_array_ops.cc\nindex 4e9b820eec2..b86f3968153 100644\n--- a/tensorflow/core/ops/ragged_array_ops.cc\n+++ b/tensorflow/core/ops/ragged_array_ops.cc\n@@ -99,6 +99,13 @@ REGISTER_OP(\"RaggedCross\")\n       int dense_start = num_ragged * 2 + num_sparse * 3;\n       for (int i = 0; i < dense_types.size(); ++i) {\n         ShapeHandle dense_input = c->input(i + dense_start);\n+        int32 rank = c->Rank(dense_input);\n+        if (rank == InferenceContext::kUnknownRank) {\n+          continue;\n+        } else if (rank != 2) {\n+          return errors::InvalidArgument(\n+              \"tf.ragged.cross only supports inputs with rank=2\");\n+        }\n         int64_t batch_size = c->Value(c->Dim(dense_input, 0));\n         if (batch_size != InferenceContext::kUnknownDim) {\n           ShapeHandle row_splits = c->Vector(batch_size + 1);"