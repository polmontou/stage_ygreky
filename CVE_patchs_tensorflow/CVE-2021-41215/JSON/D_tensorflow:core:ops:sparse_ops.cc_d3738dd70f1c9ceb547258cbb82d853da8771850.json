"diff --git a/tensorflow/core/ops/sparse_ops.cc b/tensorflow/core/ops/sparse_ops.cc\nindex b1e40e66af8..c79aeebd94b 100644\n--- a/tensorflow/core/ops/sparse_ops.cc\n+++ b/tensorflow/core/ops/sparse_ops.cc\n@@ -16,6 +16,7 @@ limitations under the License.\n #include \"tensorflow/core/framework/common_shape_fns.h\"\n #include \"tensorflow/core/framework/op.h\"\n #include \"tensorflow/core/framework/shape_inference.h\"\n+#include \"tensorflow/core/framework/types.pb.h\"\n #include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n@@ -159,6 +160,8 @@ REGISTER_OP(\"DeserializeSparse\")\n     .Attr(\"Tserialized: {string, variant} = DT_STRING\")\n     .SetShapeFn([](InferenceContext* c) {\n       // serialized sparse is [?, ..., ?, 3] vector.\n+      ShapeHandle unused_shape;\n+      TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), 1, &unused_shape));\n       DimensionHandle unused;\n       TF_RETURN_IF_ERROR(c->WithValue(c->Dim(c->input(0), -1), 3, &unused));\n       c->set_output(0, c->Matrix(InferenceContext::kUnknownDim,"