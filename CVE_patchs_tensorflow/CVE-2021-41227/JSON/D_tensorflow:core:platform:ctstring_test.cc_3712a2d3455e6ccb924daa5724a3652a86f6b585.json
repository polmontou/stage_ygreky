"diff --git a/tensorflow/core/platform/ctstring_test.cc b/tensorflow/core/platform/ctstring_test.cc\nindex a2173a523a2..d1e76812f4d 100644\n--- a/tensorflow/core/platform/ctstring_test.cc\n+++ b/tensorflow/core/platform/ctstring_test.cc\n@@ -18,6 +18,7 @@ limitations under the License.\n #include <memory>\n #include <string>\n \n+#include \"tensorflow/core/platform/ctstring_internal.h\"\n #include \"tensorflow/core/platform/test.h\"\n \n static const char kLongString[] =\n@@ -380,3 +381,29 @@ TEST(TF_CTStringTest, ResizeReserve) {\n     TF_TString_Dealloc(&s70);\n   }\n }\n+\n+TEST(TF_CTStringTest, OffsetType) {\n+  {\n+    TF_TString s71;\n+\n+    TF_TString_Init(&s71);\n+    size_t header_length = 24;\n+    size_t size = 8;\n+    TF_TString_ResizeUninitialized(&s71, header_length + size);\n+    uint32_t save_size = s71.u.offset.size;\n+    uint32_t save_offset = s71.u.offset.offset;\n+    uint32_t save_count = s71.u.offset.count;\n+\n+    s71.u.offset.size = TF_TString_ToInternalSizeT(size, TF_TSTR_OFFSET);\n+    s71.u.offset.offset = header_length;\n+    s71.u.offset.count = 0;\n+    EXPECT_EQ(size, TF_TString_GetSize(&s71));\n+    EXPECT_EQ(TF_TSTR_OFFSET, TF_TString_GetType(&s71));\n+\n+    // restore state so string can be deallocated\n+    s71.u.offset.size = save_size;\n+    s71.u.offset.offset = save_offset;\n+    s71.u.offset.count = save_count;\n+    TF_TString_Dealloc(&s71);\n+  }\n+}"