"diff --git a/tensorflow/core/kernels/bincount_op.cc b/tensorflow/core/kernels/bincount_op.cc\nindex 0f661dd9f20..aad11a45a09 100644\n--- a/tensorflow/core/kernels/bincount_op.cc\n+++ b/tensorflow/core/kernels/bincount_op.cc\n@@ -276,6 +276,9 @@ class DenseBincountOp : public OpKernel {\n     const Tensor& size_t = ctx->input(1);\n     const Tensor& weights = ctx->input(2);\n \n+    OP_REQUIRES(ctx, size_t.dims() == 0,\n+                errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n+                                        size_t.dims()));\n     Tidx size = size_t.scalar<Tidx>()();\n     OP_REQUIRES(\n         ctx, size >= 0,\n@@ -372,6 +375,9 @@ class SparseBincountOp : public OpKernel {\n     const auto weights = ctx->input(4).flat<T>();\n     const int64_t weights_size = weights.size();\n \n+    OP_REQUIRES(ctx, size_t.dims() == 0,\n+                errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n+                                        size_t.dims()));\n     Tidx size = size_t.scalar<Tidx>()();\n     OP_REQUIRES(\n         ctx, size >= 0,\n@@ -462,6 +468,9 @@ class RaggedBincountOp : public OpKernel {\n     const auto weights = ctx->input(3).flat<T>();\n     const int64_t weights_size = weights.size();\n \n+    OP_REQUIRES(ctx, size_t.dims() == 0,\n+                errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n+                                        size_t.dims()));\n     Tidx size = size_t.scalar<Tidx>()();\n     OP_REQUIRES(\n         ctx, size >= 0,"