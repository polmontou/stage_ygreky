"diff --git a/tensorflow/core/ops/math_ops.cc b/tensorflow/core/ops/math_ops.cc\nindex a23f159cbfc..3f653287fdb 100644\n--- a/tensorflow/core/ops/math_ops.cc\n+++ b/tensorflow/core/ops/math_ops.cc\n@@ -1699,6 +1699,11 @@ REGISTER_OP(\"Bincount\")\n         return Status::OK();\n       }\n \n+      if (size_tensor->dims() != 0) {\n+        return errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n+                                       size_tensor->dims());\n+      }\n+\n       // Return `[size]` shape if size is known.\n       int32_t size_val = size_tensor->scalar<int32>()();\n       if (size_val < 0) {\n@@ -1730,6 +1735,10 @@ REGISTER_OP(\"DenseBincount\")\n         c->set_output(0, c->UnknownShape());\n         return Status::OK();\n       }\n+      if (size_tensor->dims() != 0) {\n+        return errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n+                                       size_tensor->dims());\n+      }\n \n       int64_t size_val;\n       DataType dtype;\n@@ -1771,6 +1780,10 @@ REGISTER_OP(\"SparseBincount\")\n         c->set_output(0, c->UnknownShape());\n         return Status::OK();\n       }\n+      if (size_tensor->dims() != 0) {\n+        return errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n+                                       size_tensor->dims());\n+      }\n \n       int64_t size_val;\n       DataType dtype;"