"diff --git a/tensorflow/lite/kernels/embedding_lookup_sparse.cc b/tensorflow/lite/kernels/embedding_lookup_sparse.cc\nindex a0b9586203a..270ccc929d9 100644\n--- a/tensorflow/lite/kernels/embedding_lookup_sparse.cc\n+++ b/tensorflow/lite/kernels/embedding_lookup_sparse.cc\n@@ -159,6 +159,7 @@ TfLiteStatus Eval(TfLiteContext* context, TfLiteNode* node) {\n   TF_LITE_ENSURE_OK(context, GetInputSafe(context, node, 3, &weights));\n   const TfLiteTensor* value;\n   TF_LITE_ENSURE_OK(context, GetInputSafe(context, node, 4, &value));\n+  const size_t values_size = NumElements(value);\n \n   const int lookup_rank = SizeOfDimension(indices, 1);\n   const int embedding_rank = NumDimensions(value);\n@@ -253,6 +254,11 @@ TfLiteStatus Eval(TfLiteContext* context, TfLiteNode* node) {\n     current_squares_weight += w * w;\n     current_total_weight += w;\n     for (int k = 0; k < embedding_size; k++) {\n+      // only index if indices are valid\n+      if (current_output_offset + k < 0) continue;\n+      if (current_output_offset + k >= output_size) continue;\n+      if (example_embedding_offset + k < 0) continue;\n+      if (example_embedding_offset + k >= values_size) continue;\n       output_ptr[current_output_offset + k] +=\n           value_ptr[example_embedding_offset + k] * w;\n     }"