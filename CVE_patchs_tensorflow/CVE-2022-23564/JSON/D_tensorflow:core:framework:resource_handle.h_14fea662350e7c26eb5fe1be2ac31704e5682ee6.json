"diff --git a/tensorflow/core/framework/resource_handle.h b/tensorflow/core/framework/resource_handle.h\nindex 0db8e2fcf4d..46926720a00 100644\n--- a/tensorflow/core/framework/resource_handle.h\n+++ b/tensorflow/core/framework/resource_handle.h\n@@ -46,6 +46,11 @@ class ResourceHandle {\n   ResourceHandle(const ResourceHandleProto& proto);\n   ~ResourceHandle();\n \n+  // Use this factory method if the `proto` comes from user controlled input, to\n+  // prevent a denial of service.\n+  static Status BuildResourceHandle(const ResourceHandleProto& proto,\n+                                    ResourceHandle* out);\n+\n   // Unique name for the device containing the resource.\n   const std::string& device() const { return device_; }\n \n@@ -91,7 +96,7 @@ class ResourceHandle {\n \n   // Conversion to and from ResourceHandleProto\n   void AsProto(ResourceHandleProto* proto) const;\n-  void FromProto(const ResourceHandleProto& proto);\n+  Status FromProto(const ResourceHandleProto& proto);\n \n   // Serialization via ResourceHandleProto\n   std::string SerializeAsString() const;"