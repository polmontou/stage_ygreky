"diff --git a/tensorflow/core/kernels/sparse/sparse_tensor_to_csr_sparse_matrix_op.cc b/tensorflow/core/kernels/sparse/sparse_tensor_to_csr_sparse_matrix_op.cc\nindex 36c9f85e197..acb201893ce 100644\n--- a/tensorflow/core/kernels/sparse/sparse_tensor_to_csr_sparse_matrix_op.cc\n+++ b/tensorflow/core/kernels/sparse/sparse_tensor_to_csr_sparse_matrix_op.cc\n@@ -67,6 +67,13 @@ class SparseTensorToCSRSparseMatrixCPUOp : public OpKernel {\n     const Tensor& values = ctx->input(1);\n     const Tensor& dense_shape = ctx->input(2);\n     const int rank = dense_shape.NumElements();\n+    OP_REQUIRES(\n+        ctx, TensorShapeUtils::IsVector(dense_shape.shape()),\n+        errors::InvalidArgument(\"dense_shape must be rank 1 but got rank\",\n+                                dense_shape.shape().dims()));\n+    OP_REQUIRES(ctx, TensorShapeUtils::IsMatrix(indices.shape()),\n+                errors::InvalidArgument(\"indices must be rank 2 but got rank\",\n+                                        indices.shape().dims()));\n     OP_REQUIRES(ctx, rank == 2 || rank == 3,\n                 errors::InvalidArgument(\"SparseTensor must have rank 2 or 3; \",\n                                         \"but indices has rank: \", rank));"