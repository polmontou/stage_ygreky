"diff --git a/tensorflow/core/framework/shape_inference.cc b/tensorflow/core/framework/shape_inference.cc\nindex 9f854788b1a..2dedd683d7c 100644\n--- a/tensorflow/core/framework/shape_inference.cc\n+++ b/tensorflow/core/framework/shape_inference.cc\n@@ -26,6 +26,7 @@ limitations under the License.\n #include \"tensorflow/core/lib/strings/numbers.h\"\n #include \"tensorflow/core/lib/strings/scanner.h\"\n #include \"tensorflow/core/lib/strings/str_util.h\"\n+#include \"tensorflow/core/util/overflow.h\"\n \n namespace tensorflow {\n namespace shape_inference {\n@@ -1111,7 +1112,7 @@ Status InferenceContext::Multiply(DimensionHandle first,\n     *out = UnknownDim();\n   } else {\n     // Invariant: Both values are known and greater than 1.\n-    const int64_t product = first_value * second_value;\n+    const int64_t product = MultiplyWithoutOverflow(first_value, second_value);\n     if (product < 0) {\n       return errors::InvalidArgument(\n           \"Negative dimension size caused by overflow when multiplying \","