"diff --git a/tensorflow/python/tools/saved_model_cli_test.py b/tensorflow/python/tools/saved_model_cli_test.py\nindex 9a4cfcd4a02..424f156b86b 100644\n--- a/tensorflow/python/tools/saved_model_cli_test.py\n+++ b/tensorflow/python/tools/saved_model_cli_test.py\n@@ -382,7 +382,7 @@ Defined Functions:\n     input_expr_str = 'input3=np.zeros([2,2]);input4=[4,5]'\n     input_dict = saved_model_cli.preprocess_inputs_arg_string(input_str)\n     input_expr_dict = saved_model_cli.preprocess_input_exprs_arg_string(\n-        input_expr_str)\n+        input_expr_str, safe=False)\n     self.assertTrue(input_dict['input1'] == ('/path/file.txt', 'ab3'))\n     self.assertTrue(input_dict['input2'] == ('file2', None))\n     print(input_expr_dict['input3'])\n@@ -418,6 +418,11 @@ Defined Functions:\n           }\n     \"\"\", feature)\n \n+  def testInputPreprocessExampleWithCodeInjection(self):\n+    input_examples_str = 'inputs=os.system(\"echo hacked\")'\n+    with self.assertRaisesRegex(RuntimeError, 'not a valid python literal.'):\n+      saved_model_cli.preprocess_input_examples_arg_string(input_examples_str)\n+\n   def testInputPreProcessFileNames(self):\n     input_str = (r'inputx=C:\\Program Files\\data.npz[v:0];'\n                  r'input:0=c:\\PROGRA~1\\data.npy')\n@@ -434,8 +439,8 @@ Defined Functions:\n     with self.assertRaises(RuntimeError):\n       saved_model_cli.preprocess_inputs_arg_string(input_str)\n     input_str = 'inputx:np.zeros((5))'\n-    with self.assertRaises(RuntimeError):\n-      saved_model_cli.preprocess_input_exprs_arg_string(input_str)\n+    with self.assertRaisesRegex(RuntimeError, 'format is incorrect'):\n+      saved_model_cli.preprocess_input_exprs_arg_string(input_str, safe=False)\n \n   def testInputParserNPY(self):\n     x0 = np.array([[1], [2]])"