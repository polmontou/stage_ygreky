"diff --git a/tensorflow/core/kernels/sobol_op.cc b/tensorflow/core/kernels/sobol_op.cc\nindex 94fff6baea2..ea3de5056f9 100644\n--- a/tensorflow/core/kernels/sobol_op.cc\n+++ b/tensorflow/core/kernels/sobol_op.cc\n@@ -24,6 +24,7 @@ limitations under the License.\n #include \"sobol_data.h\"  // from @sobol_data\n #include \"tensorflow/core/framework/device_base.h\"\n #include \"tensorflow/core/framework/op_kernel.h\"\n+#include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/lib/core/threadpool.h\"\n #include \"tensorflow/core/platform/platform_strings.h\"\n \n@@ -134,8 +135,14 @@ class SobolSampleOp : public OpKernel {\n       : OpKernel(context) {}\n \n   void Compute(OpKernelContext* context) override {\n+    OP_REQUIRES(context, TensorShapeUtils::IsScalar(context->input(0).shape()),\n+                errors::InvalidArgument(\"dim must be a scalar\"));\n     int32_t dim = context->input(0).scalar<int32_t>()();\n+    OP_REQUIRES(context, TensorShapeUtils::IsScalar(context->input(0).shape()),\n+                errors::InvalidArgument(\"num_results must be a scalar\"));\n     int32_t num_results = context->input(1).scalar<int32_t>()();\n+    OP_REQUIRES(context, TensorShapeUtils::IsScalar(context->input(0).shape()),\n+                errors::InvalidArgument(\"skip must be a scalar\"));\n     int32_t skip = context->input(2).scalar<int32_t>()();\n \n     OP_REQUIRES(context, dim >= 1,"