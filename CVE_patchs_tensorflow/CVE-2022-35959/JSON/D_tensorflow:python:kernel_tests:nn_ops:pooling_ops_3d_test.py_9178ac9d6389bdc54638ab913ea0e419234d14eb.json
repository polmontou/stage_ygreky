"diff --git a/tensorflow/python/kernel_tests/nn_ops/pooling_ops_3d_test.py b/tensorflow/python/kernel_tests/nn_ops/pooling_ops_3d_test.py\nindex 71bf5d02bcb..9c8f11eb743 100644\n--- a/tensorflow/python/kernel_tests/nn_ops/pooling_ops_3d_test.py\n+++ b/tensorflow/python/kernel_tests/nn_ops/pooling_ops_3d_test.py\n@@ -18,6 +18,7 @@ import numpy as np\n \n from tensorflow.python.eager import context\n from tensorflow.python.framework import constant_op\n+from tensorflow.python.framework import dtypes\n from tensorflow.python.framework import errors\n from tensorflow.python.framework import errors_impl\n from tensorflow.python.framework import test_util\n@@ -67,7 +68,7 @@ class PoolingTest(test.TestCase):\n     # Initializes the input tensor with array containing incrementing\n     # numbers from 1.\n     x = [f * 1.0 for f in range(1, total_size + 1)]\n-    with self.cached_session(use_gpu=use_gpu) as sess:\n+    with self.cached_session(use_gpu=use_gpu):\n       t = constant_op.constant(x, shape=input_sizes)\n       window = [1] + list(window) + [1]\n       strides = [1] + list(strides) + [1]\n@@ -124,6 +125,23 @@ class PoolingTest(test.TestCase):\n         padding=\"SAME\",\n         expected=expected_output)\n \n+  def testMaxPool3dGrad(self):\n+    with self.assertRaises(\n+        (errors.ResourceExhaustedError, errors.InvalidArgumentError)):\n+      with self.cached_session():\n+        orig_input_shape = constant_op.constant(\n+            1879048192, shape=[5], dtype=dtypes.int32)\n+        grad = constant_op.constant(\n+            1, shape=[1, 3, 2, 4, 2], dtype=dtypes.float32)\n+        t = gen_nn_ops.AvgPool3DGrad(\n+            orig_input_shape=orig_input_shape,\n+            grad=grad,\n+            ksize=[1, 1, 1, 1, 1],\n+            strides=[1, 1, 1, 1, 1],\n+            padding=\"SAME\",\n+            data_format=\"NDHWC\")\n+        self.evaluate(t)\n+\n   def testMaxPool3dValidPadding(self):\n     expected_output = [40.0, 41.0, 42.0]\n     self._VerifyValues("