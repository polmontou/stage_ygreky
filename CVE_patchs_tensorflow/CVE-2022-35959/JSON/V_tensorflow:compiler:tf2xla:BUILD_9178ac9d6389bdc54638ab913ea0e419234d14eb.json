"load(\"//tensorflow/core/platform:rules_cc.bzl\", \"cc_library\")\nload(\"//tensorflow:tensorflow.bzl\", \"if_google\", \"if_libtpu\", \"tf_cc_binary\", \"tf_cc_test\", \"tf_copts\", \"tf_cuda_cc_test\", \"tf_gen_op_wrapper_py\", \"tf_openmp_copts\")\nload(\"//tensorflow:tensorflow.bzl\", \"cuda_py_test\")\nload(\n    \"//tensorflow/core/platform/default:cuda_build_defs.bzl\",\n    \"if_cuda_is_configured\",\n)\nload(\n    \"//tensorflow/core/platform:build_config.bzl\",\n    \"tf_additional_tensor_coding_deps\",\n    \"tf_proto_library\",\n)\nload(\"//tensorflow/compiler/xla:xla.bzl\", \"xla_py_proto_library\")\n\n# buildifier: disable=same-origin-load\nload(\"//tensorflow:tensorflow.bzl\", \"filegroup\")\n\n# buildifier: disable=same-origin-load\nload(\"//tensorflow:tensorflow.bzl\", \"get_compatible_with_portable\")\nload(\"@local_config_rocm//rocm:build_defs.bzl\", \"if_rocm_is_configured\")\nload(\"//tensorflow/compiler/xla/service/cpu:build_defs.bzl\", \"runtime_copts\")\n\npackage(\n    default_visibility = [\":internal\"],\n    licenses = [\"notice\"],\n)\n\npackage_group(\n    name = \"internal\",\n    packages = [\n        \"//tensorflow/compiler/aot/...\",\n        \"//tensorflow/compiler/jit/...\",\n        \"//tensorflow/compiler/mlir/...\",\n        \"//tensorflow/compiler/tests/...\",\n        \"//tensorflow/compiler/tf2xla/...\",\n        \"//tensorflow/core/tpu/...\",\n        \"//tensorflow/python/compiler/...\",\n    ],\n)\n\npackage_group(\n    name = \"friends\",\n    includes = [\":internal\"],\n    packages = [\n        \"//tensorflow/...\",\n        \"//tensorflow_models/...\",\n        \"//third_party/deepmind/deepmind_research/density_functional_approximation_dm21/...\",\n        \"//third_party/mlir_edge/model_curriculum/iree/...\",\n        \"//third_party/mlperf/submissions/training/v0_7/models/...\",\n        \"//third_party/py/keras/...\",\n        \"//waymo/ml/deploy/benchmark/...\",\n    ],\n)\n\ncc_library(\n    name = \"tf2xla_supported_ops_lib\",\n    srcs = [\"tf2xla_supported_ops.cc\"],\n    hdrs = [\"tf2xla_supported_ops.h\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":xla_compiler\",\n        \":xla_op_registry\",\n        \"//tensorflow/compiler/tf2xla/kernels:xla_ops\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:ops\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cc_binary(\n    name = \"tf2xla_supported_ops\",\n    srcs = [\"tf2xla_supported_ops_main.cc\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\":tf2xla_supported_ops_lib\"],\n)\n\ntf_proto_library(\n    name = \"tf2xla_support_proto\",\n    srcs = [\"support.proto\"],\n    cc_api_version = 2,\n    visibility = [\"//visibility:public\"],\n)\n\nxla_py_proto_library(\n    name = \"tf2xla_support_py_pb2\",\n    has_services = False,\n    api_version = 2,\n    visibility = [\"//visibility:public\"],\n    deps = [\":tf2xla_support_proto\"],\n)\n\ntf_proto_library(\n    name = \"tf2xla_proto\",\n    srcs = [\"tf2xla.proto\"],\n    cc_api_version = 2,\n    protodeps = [\n        \"//tensorflow/core:protos_all\",\n    ],\n    visibility = [\"//visibility:public\"],\n)\n\nxla_py_proto_library(\n    name = \"tf2xla_py\",\n    has_services = False,\n    api_version = 2,\n    visibility = [\"//visibility:public\"],\n    deps = [\":tf2xla_proto\"],\n)\n\ntf_proto_library(\n    name = \"host_compute_metadata_proto\",\n    srcs = [\"host_compute_metadata.proto\"],\n    cc_api_version = 2,\n    protodeps = [\n        \"//tensorflow/core:protos_all\",\n    ],\n    visibility = [\"//visibility:public\"],\n)\n\ncc_library(\n    name = \"graph_compiler_util\",\n    srcs = [\"graph_compiler_util.cc\"],\n    hdrs = [\"graph_compiler_util.h\"],\n    visibility = [\":friends\"],\n    deps = [\n        \":functionalize_control_flow\",\n        \":sharding_util\",\n        \":tf2xla_proto_cc\",\n        \":tf2xla_util\",\n        \":xla_compiler\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"tf2xla\",\n    srcs = [\"tf2xla.cc\"],\n    hdrs = [\"tf2xla.h\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":common\",\n        \":graph_compiler_util\",\n        \":tf2xla_proto_cc\",\n        \":tf2xla_util\",\n        \":xla_compiler\",\n        \":xla_op_registry\",\n        \"//tensorflow/compiler/aot:aot_only_var_handle_op\",\n        \"//tensorflow/compiler/tf2xla/kernels:xla_ops\",\n        \"//tensorflow/compiler/xla/client\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"mlir_tf2xla\",\n    srcs = [\"mlir_tf2xla.cc\"],\n    hdrs = [\"tf2xla.h\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":tf2xla_proto_cc\",\n        \":tf2xla_util\",\n        \":xla_compiler\",\n        \"//tensorflow/compiler/jit\",\n        \"//tensorflow/compiler/mlir/hlo\",\n        \"//tensorflow/compiler/mlir/tensorflow\",\n        \"//tensorflow/compiler/mlir/tensorflow:compile_mlir_util\",\n        \"//tensorflow/compiler/mlir/tensorflow:device_util\",\n        \"//tensorflow/compiler/mlir/tensorflow:error_util\",\n        \"//tensorflow/compiler/mlir/tensorflow:import_model\",\n        \"//tensorflow/compiler/mlir/tensorflow:import_utils\",\n        \"//tensorflow/compiler/mlir/tensorflow:mlir_roundtrip_flags\",\n        \"//tensorflow/compiler/mlir/tensorflow:tensorflow_passes\",\n        \"//tensorflow/compiler/mlir/tensorflow:tf_dialect_passes\",\n        \"//tensorflow/compiler/mlir/xla:mlir_hlo_to_hlo\",\n        \"//tensorflow/compiler/xla/client\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/strings\",\n        \"@llvm-project//mlir:FuncDialect\",\n        \"@llvm-project//mlir:IR\",\n        \"@llvm-project//mlir:ShapeDialect\",\n    ],\n)\n\n# The filegroups below are explicitly used by\n# tensorflow/tools/pip_package:build_pip_package to ensure we include the proper\n# sources for the XLA AOT CPU runtime; as these are necessary outside of bazel\n# when linking tfcompile objects using saved_model_cli (e.g. using the\n# tensorflow pip package). The associated .cc files are included in tensorflow\n# pip package's xla_aot_runtime_srcs/ subdirectory. All necessary headers are\n# also included in the pip package's include/tensorflow/ and include/external/\n# subdirectories. Note however that sometimes additional object files may need\n# to be linked when linking aot xla objects, e.g. abseil libraries. See the deps\n# attribute of the \"xla_compiled_cpu_runtime_standalone\" target below for an\n# exhaustive list.\nfilegroup(\n    name = \"xla_compiled_cpu_runtime_hdrs\",\n    srcs = [\n        \"xla_compiled_cpu_function.h\",\n        \"//tensorflow/compiler/xla:cpu_runtime_hdrs\",\n        \"//tensorflow/compiler/xla/service/cpu:runtime_hdrs\",\n        \"//tensorflow/core/kernels:xla_cpu_runtime_hdrs\",\n        \"//tensorflow/core/platform:xla_cpu_runtime_srcs\",\n    ],\n    visibility = [\"//tensorflow/tools/pip_package:__pkg__\"],\n)\n\nfilegroup(\n    name = \"xla_compiled_cpu_runtime_srcs\",\n    srcs = [\n        \"xla_compiled_cpu_function.cc\",\n        \"//tensorflow/compiler/xla:cpu_runtime_srcs\",\n        \"//tensorflow/compiler/xla/service/cpu:runtime_srcs\",\n        \"//tensorflow/core/kernels:xla_cpu_runtime_srcs\",\n        \"//tensorflow/core/platform:xla_cpu_runtime_srcs\",\n    ],\n    visibility = [\"//tensorflow/tools/pip_package:__pkg__\"],\n)\n\n# This stand-alone target is used to ensure that we can build tf_library type\n# targets against the subset of sources declared in\n# xla_compiled_cpu_runtime_{srcs,hdrs}.\n#\n# The macros in tensorflow/python/tools/tools.bzl produce AOT compiled binaries\n# that rely on this target, as do unit tests in tensorflow/python/tools.\n#\n# See above for the significance of the source filegroups.\ncc_library(\n    name = \"xla_compiled_cpu_runtime_standalone\",\n    srcs = [\n        \":xla_compiled_cpu_runtime_srcs\",\n    ],\n    hdrs = [\n        \":xla_compiled_cpu_runtime_hdrs\",\n    ],\n    copts = runtime_copts() + tf_openmp_copts(),\n    features = [\"fully_static_link\"],\n    linkstatic = 1,\n    visibility = [\":friends\"],\n    # Note, we specifically removed MKL and multithreaded dependencies so the\n    # standalone does not require the MKL binary blob or threading libraries.\n    #\n    # TODO(ebrevdo): Remove tf_additoinal_tensor_coding_deps in favor of\n    # absl/strings:cord when we update absl to a newer version.\n    deps = [\n        \"@com_google_absl//absl/base\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/base:dynamic_annotations\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/synchronization\",\n        \"//third_party/eigen3\",\n        \"//tensorflow/compiler/xla/service:custom_call_status_internal\",\n        \"//tensorflow/core/framework:numeric_types\",\n        \"//tensorflow/core/platform:bfloat16\",\n        \"//tensorflow/core/platform:stringpiece\",\n        # Extra dependencies required for multithreaded runtime objects.\n        \"//tensorflow/core/platform:blocking_counter\",\n        \"//tensorflow/core/platform:logging\",\n        \"//tensorflow/core/platform:mutex\",\n    ] + tf_additional_tensor_coding_deps(),\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_compiled_cpu_function\",\n    srcs = [\"xla_compiled_cpu_function.cc\"],\n    hdrs = [\"xla_compiled_cpu_function.h\"],\n    compatible_with = get_compatible_with_portable(),\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \"//tensorflow/compiler/xla/service:custom_call_status_internal\",\n        # Keep dependencies to a minimum here; this library is used in every AOT\n        # binary produced by tfcompile.\n        \"//tensorflow/compiler/xla:cpu_function_runtime\",\n        \"//tensorflow/compiler/xla:executable_run_options\",\n        \"//tensorflow/core/platform:types\",\n    ],\n)\n\ntf_cc_test(\n    name = \"cpu_function_runtime_test\",\n    srcs = [\"cpu_function_runtime_test.cc\"],\n    deps = [\n        \"//tensorflow/compiler/xla:cpu_function_runtime\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n    ],\n)\n\ncc_library(\n    name = \"xla_jit_compiled_cpu_function\",\n    srcs = [\"xla_jit_compiled_cpu_function.cc\"],\n    hdrs = [\"xla_jit_compiled_cpu_function.h\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":tf2xla\",\n        \":tf2xla_proto_cc\",\n        \":xla_compiled_cpu_function\",\n        \"//tensorflow/compiler/xla:cpu_function_runtime\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/compiler/xla/client:client_library\",\n        \"//tensorflow/compiler/xla/client:local_client\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/compiler/xla/service:platform_util\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/stream_executor:platform\",\n    ] + if_libtpu(\n        if_false = [\n            \"//tensorflow/compiler/xla/service:cpu_plugin\",\n            \"//tensorflow/compiler/xla/service/cpu:buffer_info_util\",\n            \"//tensorflow/compiler/xla/service/cpu:cpu_executable\",\n        ],\n        if_true = [],\n    ),\n)\n\ncc_library(\n    name = \"xla_compiler\",\n    srcs = [\n        \"const_analysis.cc\",\n        \"graph_compiler.cc\",\n        \"xla_compiler.cc\",\n        \"xla_op_kernel.cc\",\n        \"xla_cpu_backend.cc\",\n    ] + if_cuda_is_configured([\n        \"xla_gpu_backend.cc\",\n    ]) + if_rocm_is_configured([\n        \"xla_gpu_backend.cc\",\n    ]),\n    hdrs = [\n        \"const_analysis.h\",\n        \"graph_compiler.h\",\n        \"xla_compiler.h\",\n        \"xla_helpers.h\",\n        \"xla_op_kernel.h\",\n        \"xla_op_registry.h\",\n    ],\n    copts = tf_copts(),\n    visibility = [\":friends\"],\n    deps = [\n        \":common\",\n        \":layout_util\",\n        \":host_compute_metadata_proto_cc\",\n        \":rearrange_function_argument\",\n        \":sharding_util\",\n        \":side_effect_util\",\n        \":tf2xla_util\",\n        \":xla_argument\",\n        \":xla_compilation_device\",\n        \":xla_context\",\n        \":xla_expression\",\n        \":xla_helpers\",\n        \":xla_op_registry\",\n        \":xla_resource\",\n        \"//tensorflow/compiler/mlir:mlir_bridge_rollout_policy\",\n        \"@com_google_absl//absl/algorithm:container\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n        \"@com_google_absl//absl/types:variant\",\n        \"//tensorflow/compiler/jit:common\",\n        \"//tensorflow/compiler/jit:flags\",\n        \"//tensorflow/compiler/jit:shape_inference\",\n        \"//tensorflow/compiler/mlir:array_container_utils\",\n        \"//tensorflow/compiler/mlir/tensorflow:compile_mlir_util_no_tf_dialect_passes\",\n        \"//tensorflow/compiler/xla/client:value_inference\",\n        \"//tensorflow/compiler/xla/service:computation_placer_hdr\",\n        \"//tensorflow/compiler/xla:executable_run_options\",\n        \"//tensorflow/compiler/xla:protobuf_util\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:util\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/compiler/xla/client:client_library\",\n        \"//tensorflow/compiler/xla/client:local_client\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/compiler/xla/service:hlo\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:lib_internal\",\n        \"//tensorflow/core:ops\",\n        \"//tensorflow/core:protos_all_cc\",\n    ] + if_libtpu([\n        \":xla_tpu_backend_registration\",\n    ]),\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_compilation_device\",\n    srcs = [\n        \"xla_compilation_device.cc\",\n    ],\n    hdrs = [\n        \"xla_compilation_device.h\",\n    ],\n    deps = [\n        \":common\",\n        \":frontend_attributes_util\",\n        \":sharding_util\",\n        \":xla_context\",\n        \":xla_helpers\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:session_options\",\n        \"//tensorflow/core/common_runtime:core_cpu_internal\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_tpu_backend_registration\",\n    srcs = [\"xla_tpu_backend.cc\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":xla_op_registry\",\n        \"//tensorflow/core/tpu:tpu_defs\",\n        \"//tensorflow/core/tpu:tpu_node_device_util\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_context\",\n    srcs = [\n        \"xla_context.cc\",\n    ],\n    hdrs = [\n        \"xla_context.h\",\n    ],\n    deps = [\n        \":common\",\n        \":xla_expression\",\n        \":xla_helpers\",\n        \"//tensorflow/compiler/xla:literal\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/compiler/xla/client:client_library\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core/common_runtime:core_cpu_internal\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_op_registry\",\n    srcs = [\n        \"xla_op_registry.cc\",\n    ],\n    hdrs = [\n        \"xla_op_registry.h\",\n    ],\n    visibility = [\":friends\"],\n    deps = [\n        \":common\",\n        \":xla_context\",\n        \"//tensorflow/compiler/jit:flags\",\n        \"//tensorflow/compiler/jit:xla_cluster_util\",\n        \"//tensorflow/compiler/xla/client:client_library\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:session_options\",\n        \"//tensorflow/core/common_runtime:core_cpu_internal\",\n        \"//tensorflow/core/platform:stream_executor_no_cuda\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_expression\",\n    srcs = [\n        \"xla_expression.cc\",\n    ],\n    hdrs = [\n        \"xla_expression.h\",\n    ],\n    deps = [\n        \":common\",\n        \":xla_resource\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla/client\",\n        \"//tensorflow/compiler/xla/client:value_inference\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_resource\",\n    srcs = [\n        \"xla_resource.cc\",\n    ],\n    hdrs = [\n        \"xla_resource.h\",\n    ],\n    deps = [\n        \":common\",\n        \":sharding_util\",\n        \":xla_helpers\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_helpers\",\n    srcs = [\n        \"xla_helpers.cc\",\n    ],\n    hdrs = [\n        \"xla_helpers.h\",\n    ],\n    visibility = [\":friends\"],\n    deps = [\n        \":common\",\n        \":host_compute_metadata_proto_cc\",\n        \"//tensorflow/compiler/tf2xla/lib:util\",\n        \"//tensorflow/compiler/xla:executable_run_options\",\n        \"//tensorflow/compiler/xla:types\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/compiler/xla/client/lib:arithmetic\",\n        \"//tensorflow/compiler/xla/client/lib:constants\",\n        \"//tensorflow/compiler/xla/service:computation_placer_hdr\",\n        \"//tensorflow/compiler/xla/service:hlo\",\n        \"//tensorflow/compiler/xla/service/gpu:gpu_executable_run_options\",\n        \"//tensorflow/core:core_cpu_base\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/stream_executor:stream_header\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"xla_argument\",\n    srcs = [\n        \"xla_argument.cc\",\n    ],\n    hdrs = [\n        \"xla_argument.h\",\n    ],\n    deps = [\n        \":host_compute_metadata_proto_cc\",\n        \":xla_resource\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/compiler/xla/service:hlo\",\n        \"//tensorflow/core:framework\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n        \"@llvm-project//llvm:Support\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"layout_util\",\n    srcs = [\n        \"layout_util.cc\",\n    ],\n    hdrs = [\n        \"layout_util.h\",\n    ],\n    visibility = [\":friends\"],\n    deps = [\n        \":common\",\n        \":xla_argument\",\n        \":xla_helpers\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"common\",\n    srcs = [\n        \"literal_util.cc\",\n        \"shape_util.cc\",\n        \"type_util.cc\",\n    ],\n    hdrs = [\n        \"literal_util.h\",\n        \"shape_util.h\",\n        \"type_util.h\",\n    ],\n    visibility = [\":friends\"],\n    deps = [\n        \"//tensorflow/compiler/xla:literal\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"frontend_attributes_util\",\n    srcs = [\"frontend_attributes_util.cc\"],\n    hdrs = [\"frontend_attributes_util.h\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":tf2xla_defs\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"sharding_util\",\n    srcs = [\"sharding_util.cc\"],\n    hdrs = [\"sharding_util.h\"],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla/client:sharding_builder\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cc_test(\n    name = \"sharding_util_test\",\n    srcs = [\"sharding_util_test.cc\"],\n    deps = [\n        \":sharding_util\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/core:testlib\",\n    ],\n)\n\n# Internal targets below this point.\n\ncc_library(\n    name = \"tf2xla_defs\",\n    hdrs = [\"tf2xla_defs.h\"],\n    visibility = [\":friends\"],\n    deps = [\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"tf2xla_util\",\n    srcs = [\"tf2xla_util.cc\"],\n    hdrs = [\"tf2xla_util.h\"],\n    visibility = [\":friends\"],\n    deps = [\n        \":sharding_util\",\n        \":tf2xla_defs\",\n        \":tf2xla_proto_cc\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ntf_cc_test(\n    name = \"tf2xla_util_test\",\n    srcs = [\"tf2xla_util_test.cc\"],\n    deps = [\n        \":sharding_util\",\n        \":tf2xla_util\",\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:function_ops\",\n        \"//tensorflow/cc:functional_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:math_ops_op_lib\",\n        \"//tensorflow/core:ops\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cc_test(\n    name = \"tf2xla_test\",\n    srcs = [\"tf2xla_test.cc\"],\n    deps = [\n        \":tf2xla\",\n        \":tf2xla_proto_cc\",\n        \"//tensorflow/compiler/xla:literal\",\n        \"//tensorflow/compiler/xla:literal_util\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla/client:client_library\",\n        \"//tensorflow/compiler/xla/client:local_client\",\n        \"//tensorflow/compiler/xla/client:xla_computation\",\n        \"//tensorflow/compiler/xla/service:cpu_plugin\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n    ],\n)\n\ntf_cc_test(\n    name = \"xla_jit_compiled_cpu_function_test\",\n    srcs = [\"xla_jit_compiled_cpu_function_test.cc\"],\n    deps = [\n        \":tf2xla_proto_cc\",\n        \":xla_jit_compiled_cpu_function\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:statusor\",\n        \"//tensorflow/compiler/xla:test\",\n        \"//tensorflow/compiler/xla:xla_data_proto_cc\",\n        \"//tensorflow/compiler/xla/client:local_client\",\n        \"//tensorflow/compiler/xla/service:compiler\",\n        \"//tensorflow/compiler/xla/service:platform_util\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/stream_executor:multi_platform_manager\",\n        \"//tensorflow/stream_executor:platform\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cc_test(\n    name = \"xla_compiler_test\",\n    srcs = [\n        \"xla_compiler_test.cc\",\n        \"xla_expression_test.cc\",\n    ],\n    deps = [\n        \":common\",\n        \":layout_util\",\n        \":side_effect_util\",\n        \":xla_argument\",\n        \":xla_compiler\",\n        \":xla_expression\",\n        \":xla_resource\",\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:function_ops\",\n        \"//tensorflow/cc:functional_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/cc:resource_variable_ops\",\n        \"//tensorflow/compiler/tf2xla/kernels:xla_ops\",\n        \"//tensorflow/compiler/xla:literal\",\n        \"//tensorflow/compiler/xla:shape_util\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla/client:client_library\",\n        \"//tensorflow/compiler/xla/client:local_client\",\n        \"//tensorflow/compiler/xla/client:xla_builder\",\n        \"//tensorflow/compiler/xla/service:cpu_plugin\",\n        \"//tensorflow/compiler/xla/service:hlo_proto_cc\",\n        \"//tensorflow/compiler/xla/tests:literal_test_util\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/core:testlib\",\n        \"//tensorflow/core/framework:tensor_testutil\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cc_test(\n    name = \"literal_util_test\",\n    srcs = [\n        \"literal_util_test.cc\",\n    ],\n    deps = [\n        \":common\",\n        \"//tensorflow/compiler/xla:literal\",\n        \"//tensorflow/compiler/xla:literal_util\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/core:testlib\",\n    ],\n)\n\ntf_cc_test(\n    name = \"const_analysis_test\",\n    size = \"small\",\n    srcs = [\"const_analysis_test.cc\"],\n    deps = [\n        \":xla_compiler\",\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:function_ops\",\n        \"//tensorflow/cc:functional_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/compiler/jit:flags\",\n        \"//tensorflow/compiler/jit:xla_cluster_util\",\n        \"//tensorflow/compiler/tf2xla/kernels:xla_ops\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:ops\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n    ],\n)\n\ncc_library(\n    name = \"light_outside_compilation_kernels_for_test\",\n    testonly = True,\n    srcs = [\"light_outside_compilation_kernels_for_test.cc\"],\n    linkstatic = 1,\n    deps = [\n        \":xla_compiler\",\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:function_ops\",\n        \"//tensorflow/cc:functional_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/compiler/tf2xla/kernels:gpu_tf_kernel_custom_call\",\n        \"//tensorflow/core:framework\",\n    ],\n    alwayslink = 1,\n)\n\ntf_gen_op_wrapper_py(\n    name = \"test_ops_for_light_outside_compilation\",\n    testonly = True,\n    out = \"test_ops_for_light_outside_compilation.py\",\n    deps = [\n        \":light_outside_compilation_kernels_for_test\",\n    ],\n)\n\ncuda_py_test(\n    name = \"light_outside_compilation_test\",\n    srcs = [\"light_outside_compilation_test.py\"],\n    python_version = \"PY3\",\n    tags = [\n        \"no_oss\",\n        \"no_pip\",\n    ],\n    xla_enable_strict_auto_jit = False,\n    deps = [\n        \":test_ops_for_light_outside_compilation\",\n        \"//tensorflow/compiler/mlir/python/mlir_wrapper:filecheck_wrapper\",\n    ] + if_google([\":light_outside_compilation_kernels_for_test\"]),\n)\n\ncc_library(\n    name = \"functionalize_control_flow_util\",\n    srcs = [\n        \"functionalize_control_flow_util.cc\",\n    ],\n    hdrs = [\n        \"functionalize_control_flow_util.h\",\n    ],\n    deps = [\n        \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"functionalize_cond\",\n    srcs = [\n        \"functionalize_cond.cc\",\n    ],\n    hdrs = [\n        \"functionalize_cond.h\",\n    ],\n    deps = [\n        \":frontend_attributes_util\",\n        \":functionalize_control_flow_util\",\n        \":tf2xla_util\",\n        \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:union_find\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"functionalize_control_flow\",\n    srcs = [\n        \"functionalize_control_flow.cc\",\n    ],\n    hdrs = [\n        \"functionalize_control_flow.h\",\n    ],\n    visibility = [\":friends\"],\n    deps = [\n        \":functionalize_cond\",\n        \":functionalize_control_flow_util\",\n        \":functionalize_while\",\n        \":tf2xla_util\",\n        \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:union_find\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:lib\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"mlir_bridge_pass\",\n    srcs = [\"mlir_bridge_pass.cc\"],\n    hdrs = [\"mlir_bridge_pass.h\"],\n    deps = [\n        \":tf2xla_defs\",\n        \"//tensorflow/compiler/jit:flags\",\n        \"//tensorflow/compiler/mlir:mlir_bridge_rollout_policy\",\n        \"//tensorflow/compiler/mlir:mlir_graph_optimization_pass\",\n        \"//tensorflow/compiler/mlir/tensorflow\",\n        \"//tensorflow/compiler/mlir/tensorflow:device_util\",\n        \"//tensorflow/compiler/mlir/tensorflow:tensorflow_passes\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core/common_runtime:device_set\",\n        \"@com_google_absl//absl/base\",\n        \"@llvm-project//llvm:Support\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"mlir_bridge_pass_registration\",\n    srcs = [\n        \"mlir_bridge_pass_registration.cc\",\n    ],\n    visibility = [\n        # We define a new TPU device in TFRT to enable TFRT TPU Runtime.\n        \"//learning/brain/tfrt/tf_tpu:__pkg__\",\n        \":internal\",\n    ],\n    deps = [\n        \":mlir_bridge_pass\",\n        \"//tensorflow/compiler/mlir:mlir_graph_optimization_pass_registration\",\n        \"//tensorflow/core:core_cpu\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"rearrange_function_argument\",\n    srcs = [\n        \"rearrange_function_argument.cc\",\n    ],\n    hdrs = [\n        \"rearrange_function_argument.h\",\n    ],\n    deps = [\n        \":tf2xla_util\",\n        \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:lib\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"functionalize_control_flow_pass_registration\",\n    srcs = [\n        \"functionalize_control_flow_pass_registration.cc\",\n    ],\n    visibility = [\":friends\"],\n    deps = [\n        \":functionalize_control_flow\",\n    ],\n    alwayslink = 1,\n)\n\ncc_library(\n    name = \"functionalize_while\",\n    srcs = [\n        \"functionalize_while.cc\",\n    ],\n    hdrs = [\n        \"functionalize_while.h\",\n    ],\n    deps = [\n        \":frontend_attributes_util\",\n        \":functionalize_cond\",\n        \":functionalize_control_flow_util\",\n        \":tf2xla_util\",\n        \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/compiler/xla:union_find\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:lib\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ntf_cc_test(\n    name = \"functionalize_control_flow_test\",\n    srcs = [\"functionalize_control_flow_test.cc\"],\n    deps = [\n        \":functionalize_control_flow\",\n        \":test_util\",\n        \":tf2xla_util\",\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:cc_ops_internal\",\n        \"//tensorflow/cc:function_ops\",\n        \"//tensorflow/cc:functional_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/cc:resource_variable_ops\",\n        \"//tensorflow/compiler/tf2xla/cc:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:ops\",\n        \"//tensorflow/core:resource_variable_ops_op_lib\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n    ],\n)\n\ntf_cc_test(\n    name = \"functionalize_cond_test\",\n    srcs = [\"functionalize_cond_test.cc\"],\n    deps = [\n        \":functionalize_cond\",\n        \":functionalize_control_flow\",\n        \":test_util\",\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:cc_ops_internal\",\n        \"//tensorflow/cc:function_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/cc:resource_variable_ops\",\n        \"//tensorflow/cc:scope\",\n        \"//tensorflow/compiler/tf2xla/cc:xla_ops\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:core_cpu_internal\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:ops\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:resource_variable_ops_op_lib\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/core:testlib\",\n        \"//tensorflow/core/platform:test\",\n        \"@com_google_absl//absl/container:flat_hash_set\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"test_util\",\n    testonly = 1,\n    srcs = [\"test_util.cc\"],\n    hdrs = [\"test_util.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n    ],\n)\n\ntf_cc_test(\n    name = \"xla_op_registry_test\",\n    srcs = [\"xla_op_registry_test.cc\"],\n    deps = [\n        \":xla_compiler\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n    ],\n)\n\ncc_library(\n    name = \"resource_operation_table\",\n    srcs = [\"resource_operation_table.cc\"],\n    hdrs = [\"resource_operation_table.h\"],\n    deps = [\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:ops\",\n        \"@com_google_absl//absl/algorithm:container\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cc_test(\n    name = \"resource_operation_table_test\",\n    srcs = [\"resource_operation_table_test.cc\"],\n    deps = [\n        \":resource_operation_table\",\n        \":xla_compiler\",\n        \"//tensorflow/compiler/tf2xla/kernels:xla_ops\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"@com_google_absl//absl/algorithm:container\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"side_effect_util\",\n    srcs = [\"side_effect_util.cc\"],\n    hdrs = [\"side_effect_util.h\"],\n    visibility = [\":friends\"],\n    deps = [\n        \"//tensorflow/core:core_cpu\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cuda_cc_test(\n    name = \"fused_batchnorm_reserve_space_test\",\n    size = \"medium\",\n    srcs = [\"fused_batchnorm_reserve_space_test.cc\"],\n    tags = [\n        \"no_cuda_asan\",  # TODO(b/193450885)\n    ],\n    deps = [\n        \"//tensorflow/cc:cc_ops\",\n        \"//tensorflow/cc:ops\",\n        \"//tensorflow/cc:scope\",\n        \"//tensorflow/compiler/jit\",\n        \"//tensorflow/compiler/jit:flags\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:framework_internal\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:tensorflow\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/core:testlib\",\n        \"//third_party/eigen3\",\n        \"@com_google_absl//absl/algorithm:container\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"mlir_xla_op_kernel\",\n    srcs = [\"mlir_xla_op_kernel.cc\"],\n    hdrs = [\"mlir_xla_op_kernel.h\"],\n    deps = [\n        \":xla_compiler\",\n        \"//tensorflow/compiler/jit:xla_compilation_cache\",\n        \"//tensorflow/compiler/mlir:array_container_utils\",\n        \"//tensorflow/compiler/mlir/tensorflow:compile_mlir_util_no_tf_dialect_passes\",\n        \"@llvm-project//mlir:IR\",\n    ],\n)\n\ncc_library(\n    name = \"resource_util\",\n    srcs = [\"resource_util.cc\"],\n    hdrs = [\"resource_util.h\"],\n    visibility = [\":friends\"],\n    deps = [\n        \":resource_operation_table\",\n        \"//tensorflow/compiler/xla:status_macros\",\n        \"//tensorflow/core:core_cpu\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:lib\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/stream_executor/lib\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/container:flat_hash_set\",\n        \"@com_google_absl//absl/hash\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_cuda_cc_test(\n    name = \"resource_util_test\",\n    size = \"small\",\n    srcs = [\"resource_util_test.cc\"],\n    deps = [\n        \":resource_util\",\n        \"//tensorflow/cc:scope\",\n        \"//tensorflow/core:framework\",\n        \"//tensorflow/core:graph\",\n        \"//tensorflow/core:protos_all_cc\",\n        \"//tensorflow/core:tensorflow\",\n        \"//tensorflow/core:test\",\n        \"//tensorflow/core:test_main\",\n        \"//tensorflow/core:testlib\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/container:flat_hash_set\",\n        \"@com_google_absl//absl/memory\",\n    ],\n)"