"diff --git a/tensorflow/core/kernels/conv_grad_input_ops.h b/tensorflow/core/kernels/conv_grad_input_ops.h\nindex a9db8a9795f..6fdd72e0014 100644\n--- a/tensorflow/core/kernels/conv_grad_input_ops.h\n+++ b/tensorflow/core/kernels/conv_grad_input_ops.h\n@@ -422,6 +422,11 @@ class Conv2DBackpropInputOp : public OpKernel {\n     const Tensor& filter = context->input(1);\n     const Tensor& out_backprop = context->input(2);\n \n+    OP_REQUIRES(\n+        context, out_backprop.dims() == 4,\n+        errors::InvalidArgument(\"input_sizes must be 4-dimensional, got: \",\n+                                out_backprop.dims()));\n+\n     TensorShape input_shape;\n     OP_REQUIRES_OK(context,\n                    Conv2DBackpropComputeInputShape(input_sizes, filter.shape(),\n@@ -527,6 +532,10 @@ class Conv2DCustomBackpropInputOp : public OpKernel {\n     const Tensor& input_sizes = context->input(0);\n     const Tensor& filter = context->input(1);\n     const Tensor& out_backprop = context->input(2);\n+    OP_REQUIRES(\n+        context, out_backprop.dims() == 4,\n+        errors::InvalidArgument(\"input_sizes must be 4-dimensional, got: \",\n+                                out_backprop.dims()));\n \n     TensorShape input_shape;\n     OP_REQUIRES_OK(context,"