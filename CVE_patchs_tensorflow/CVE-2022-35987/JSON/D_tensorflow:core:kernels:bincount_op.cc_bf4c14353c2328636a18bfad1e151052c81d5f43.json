"diff --git a/tensorflow/core/kernels/bincount_op.cc b/tensorflow/core/kernels/bincount_op.cc\nindex 4bef8c5be22..a45692814c7 100644\n--- a/tensorflow/core/kernels/bincount_op.cc\n+++ b/tensorflow/core/kernels/bincount_op.cc\n@@ -280,6 +280,14 @@ class DenseBincountOp : public OpKernel {\n     OP_REQUIRES(ctx, size_t.dims() == 0,\n                 errors::InvalidArgument(\"Shape must be rank 0 but is rank \",\n                                         size_t.dims()));\n+    OP_REQUIRES(ctx,\n+                weights.shape() == data.shape() || weights.NumElements() == 0,\n+                errors::InvalidArgument(\n+                    \"`weights` must be the same shape as `arr` or a length-0 \"\n+                    \"`Tensor`, in which case it acts as all weights equal to \"\n+                    \"1. Received \",\n+                    weights.shape().DebugString()));\n+\n     Tidx size = size_t.scalar<Tidx>()();\n     OP_REQUIRES(\n         ctx, size >= 0,"