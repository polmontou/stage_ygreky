"diff --git a/tensorflow/core/kernels/maxpooling_op.cc b/tensorflow/core/kernels/maxpooling_op.cc\nindex 9edd5cf6a6d..4fb198690d5 100644\n--- a/tensorflow/core/kernels/maxpooling_op.cc\n+++ b/tensorflow/core/kernels/maxpooling_op.cc\n@@ -1268,6 +1268,13 @@ class MaxPoolingNoMaskOp<GPUDevice, T> : public OpKernel {\n         ShapeFromFormat(data_format_, params.tensor_in_batch, params.out_height,\n                         params.out_width, params.depth);\n \n+    // Degenerate pooling output should return an empty tensor.\n+    if (out_shape.num_elements() == 0) {\n+      Tensor* output = nullptr;\n+      OP_REQUIRES_OK(context, context->allocate_output(0, out_shape, &output));\n+      return;\n+    }\n+\n     // Assuming qint8 <--> NCHW_VECT_C (int8x4) here.\n     constexpr bool is_int8x4 = std::is_same<T, qint8>::value;\n     OP_REQUIRES(context, (is_int8x4 == (data_format_ == FORMAT_NCHW_VECT_C)),"