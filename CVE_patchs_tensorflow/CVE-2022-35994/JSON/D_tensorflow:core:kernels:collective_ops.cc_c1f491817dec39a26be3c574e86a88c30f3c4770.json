"diff --git a/tensorflow/core/kernels/collective_ops.cc b/tensorflow/core/kernels/collective_ops.cc\nindex 7045b106d73..fd8146361df 100644\n--- a/tensorflow/core/kernels/collective_ops.cc\n+++ b/tensorflow/core/kernels/collective_ops.cc\n@@ -176,6 +176,10 @@ class CollectiveGatherOpKernel : public CollectiveOpV1Kernel {\n   void ComputeAsyncImpl(OpKernelContext* c, CollectiveExecutor* col_exec,\n                         DoneCallback done) override {\n     auto output_shape = c->input(0).shape();\n+    OP_REQUIRES_ASYNC(c, output_shape.dims() > 0,\n+                      errors::InvalidArgument(\"input should have rank > 0, \",\n+                                              \"recieved \", output_shape.dims()),\n+                      done);\n     output_shape.set_dim(\n         0, output_shape.dim_size(0) * col_params_->group.group_size);\n     col_params_->instance.shape = output_shape;"