"diff --git a/tensorflow/python/ops/collective_ops_test.py b/tensorflow/python/ops/collective_ops_test.py\nindex a95896c0a23..5b57956996b 100644\n--- a/tensorflow/python/ops/collective_ops_test.py\n+++ b/tensorflow/python/ops/collective_ops_test.py\n@@ -451,6 +451,20 @@ class CollectiveOpTest(test.TestCase):\n     ])\n     context.ensure_initialized()\n \n+  @test_util.run_v2_only\n+  def testCollectiveGatherShapeCheckFailure(self):\n+    with self.assertRaisesRegex(errors.InvalidArgumentError,\n+                                'input should have rank > 0'):\n+      collective_ops.gen_collective_ops.CollectiveGather(\n+          input=1,\n+          group_size=1,\n+          group_key=1,\n+          instance_key=1,\n+          shape=(3, 3, 3),\n+          communication_hint='auto',\n+          timeout_seconds=0,\n+          name='')\n+\n     @def_function.function\n     def run_all_reduce():\n       group_key = 10"