"diff --git a/tensorflow/core/framework/full_type_util_test.cc b/tensorflow/core/framework/full_type_util_test.cc\nindex 0324e64f96b..6037879d069 100644\n--- a/tensorflow/core/framework/full_type_util_test.cc\n+++ b/tensorflow/core/framework/full_type_util_test.cc\n@@ -510,6 +510,19 @@ TEST(SpecializeType, ForEachOverridesTargetOfNestedForEach) {\n   EXPECT_EQ(t_actual.args(1).args(0).args(0).args_size(), 0);\n }\n \n+TEST(SpecializeType, ForEachRejectsMalformedInput) {\n+  OpDef op;\n+  FullTypeDef* t = op.add_output_arg()->mutable_experimental_full_type();\n+  t->set_type_id(TFT_FOR_EACH);\n+  t->add_args()->set_type_id(TFT_PRODUCT);\n+\n+  NodeDef ndef;\n+  AttrSlice attrs(ndef);\n+\n+  FullTypeDef ft;\n+  EXPECT_FALSE(SpecializeType(attrs, op, ft).ok());\n+}\n+\n TEST(SpecializeType, RemovesLegacyVariant) {\n   OpDef op;\n   FullTypeDef* t = op.add_output_arg()->mutable_experimental_full_type();"