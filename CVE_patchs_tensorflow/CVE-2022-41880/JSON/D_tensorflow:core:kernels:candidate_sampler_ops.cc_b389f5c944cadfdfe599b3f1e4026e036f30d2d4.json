"diff --git a/tensorflow/core/kernels/candidate_sampler_ops.cc b/tensorflow/core/kernels/candidate_sampler_ops.cc\nindex 872e805873f..94eb7f2738e 100644\n--- a/tensorflow/core/kernels/candidate_sampler_ops.cc\n+++ b/tensorflow/core/kernels/candidate_sampler_ops.cc\n@@ -73,6 +73,14 @@ class BaseCandidateSamplerOp : public OpKernel {\n \n     gtl::ArraySlice<int64_t> true_candidate(\n         true_classes.matrix<int64_t>().data(), batch_size * num_true_);\n+\n+    for (const auto& candidate : true_candidate) {\n+      OP_REQUIRES(context, candidate >= 0 && candidate < sampler_->range(),\n+                  errors::InvalidArgument(\"`true_candidate` out of range [\", 0,\n+                                          \", \", sampler_->range(),\n+                                          \"), received \", candidate));\n+    }\n+\n     gtl::MutableArraySlice<int64_t> sampled_candidate(\n         out_sampled_candidates->vec<int64_t>().data(), num_sampled_);\n     gtl::MutableArraySlice<float> true_expected_count("