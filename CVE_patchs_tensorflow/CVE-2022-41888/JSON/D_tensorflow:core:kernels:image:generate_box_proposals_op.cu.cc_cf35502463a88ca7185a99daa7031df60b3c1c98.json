"diff --git a/tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc b/tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc\nindex 678bec2c15d..8702dba16fb 100644\n--- a/tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc\n+++ b/tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc\n@@ -312,6 +312,22 @@ class GenerateBoundingBoxProposals : public tensorflow::OpKernel {\n     const auto bbox_deltas = context->input(1);\n     const auto image_info = context->input(2);\n     const auto anchors = context->input(3);\n+\n+    OP_REQUIRES(context, scores.dims() == 4,\n+                errors::InvalidArgument(\"`scores` must be rank 4 but is rank \",\n+                                        scores.dims()));\n+    OP_REQUIRES(\n+        context, bbox_deltas.dims() == 4,\n+        errors::InvalidArgument(\"`bbox_deltas` must be rank 4 but is rank \",\n+                                bbox_deltas.dims()));\n+    OP_REQUIRES(\n+        context, image_info.dims() == 2,\n+        errors::InvalidArgument(\"`image_info` must be rank 2 but is rank \",\n+                                image_info.dims()));\n+    OP_REQUIRES(context, anchors.dims() == 3,\n+                errors::InvalidArgument(\"`anchors` must be rank 3 but is rank \",\n+                                        anchors.dims()));\n+\n     const auto num_images = scores.dim_size(0);\n     const auto num_anchors = scores.dim_size(3);\n     const auto height = scores.dim_size(1);"