"diff --git a/tensorflow/core/kernels/sdca_internal.cc b/tensorflow/core/kernels/sdca_internal.cc\nindex 5572cb934e4..79dc01baa4a 100644\n--- a/tensorflow/core/kernels/sdca_internal.cc\n+++ b/tensorflow/core/kernels/sdca_internal.cc\n@@ -389,6 +389,13 @@ Status Examples::Initialize(OpKernelContext* const context,\n   OpInputList dense_features_inputs;\n   TF_RETURN_IF_ERROR(\n       context->input_list(\"dense_features\", &dense_features_inputs));\n+  for (int i = 0; i < dense_features_inputs.size(); ++i) {\n+    if (!TensorShapeUtils::IsMatrix(dense_features_inputs[i].shape())) {\n+      return errors::InvalidArgument(\"Dense features at index \", i,\n+                                     \" must be rank 2 but is rank \",\n+                                     dense_features_inputs[i].dims());\n+    }\n+  }\n \n   examples_.clear();\n   examples_.resize(num_examples);"