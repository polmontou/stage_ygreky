"diff --git a/tensorflow/core/grappler/utils/functions.cc b/tensorflow/core/grappler/utils/functions.cc\nindex 8868465352f..4620886868c 100644\n--- a/tensorflow/core/grappler/utils/functions.cc\n+++ b/tensorflow/core/grappler/utils/functions.cc\n@@ -291,6 +291,11 @@ Status MakeGrapplerFunctionItem(const FunctionDef& func,\n \n   std::vector<const FunctionDef::ArgAttrs*> arg_attr(inputs.size(), nullptr);\n   for (const auto& attr : func.arg_attr()) {\n+    if (attr.first >= inputs.size()) {\n+      return errors::InvalidArgument(\"Invalid attribute index, got \",\n+                                     attr.first, \" but expected less than \",\n+                                     inputs.size());\n+    }\n     arg_attr.at(attr.first) = &attr.second;\n   }\n "