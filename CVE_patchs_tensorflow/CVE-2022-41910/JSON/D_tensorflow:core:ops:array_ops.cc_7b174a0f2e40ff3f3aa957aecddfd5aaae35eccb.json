"diff --git a/tensorflow/core/ops/array_ops.cc b/tensorflow/core/ops/array_ops.cc\nindex b57a44f44fd..8e52dde528e 100644\n--- a/tensorflow/core/ops/array_ops.cc\n+++ b/tensorflow/core/ops/array_ops.cc\n@@ -2879,6 +2879,10 @@ REGISTER_OP(\"QuantizeAndDequantizeV2\")\n                                        axis);\n       } else if (axis != -1) {\n         ShapeHandle input;\n+        if (axis >= kint32max) {\n+          return errors::InvalidArgument(\n+              \"Axis cannot be >= kint32max value, got \", axis);\n+        }\n         TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), axis + 1, &input));\n         DimensionHandle depth;\n         TF_RETURN_IF_ERROR(\n@@ -2914,6 +2918,10 @@ REGISTER_OP(\"QuantizeAndDequantizeV4\")\n                                        axis);\n       } else if (axis != -1) {\n         ShapeHandle input;\n+        if (axis >= kint32max) {\n+          return errors::InvalidArgument(\n+              \"Axis cannot be >= kint32max value, got \", axis);\n+        }\n         TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), axis + 1, &input));\n         DimensionHandle depth;\n         TF_RETURN_IF_ERROR(\n@@ -2945,6 +2953,10 @@ REGISTER_OP(\"QuantizeAndDequantizeV4Grad\")\n                                        axis);\n       } else if (axis != -1) {\n         ShapeHandle input;\n+        if (axis >= kint32max) {\n+          return errors::InvalidArgument(\n+              \"Axis cannot be >= kint32max value, got \", axis);\n+        }\n         TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), axis + 1, &input));\n         DimensionHandle depth;\n         TF_RETURN_IF_ERROR(\n@@ -2981,6 +2993,10 @@ REGISTER_OP(\"QuantizeAndDequantizeV3\")\n                                        axis);\n       } else if (axis != -1) {\n         ShapeHandle input;\n+        if (axis >= kint32max) {\n+          return errors::InvalidArgument(\n+              \"Axis cannot be >= kint32max value, got \", axis);\n+        }\n         TF_RETURN_IF_ERROR(c->WithRankAtLeast(c->input(0), axis + 1, &input));\n         DimensionHandle depth;\n         TF_RETURN_IF_ERROR("