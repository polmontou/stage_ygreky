"diff --git a/tensorflow/core/data/service/snapshot/path_utils.cc b/tensorflow/core/data/service/snapshot/path_utils.cc\nindex 050c904de0c..04b1cedf4fe 100644\n--- a/tensorflow/core/data/service/snapshot/path_utils.cc\n+++ b/tensorflow/core/data/service/snapshot/path_utils.cc\n@@ -15,10 +15,15 @@ limitations under the License.\n #include \"tensorflow/core/data/service/snapshot/path_utils.h\"\n \n #include <string>\n+#include <utility>\n+#include <vector>\n \n #include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/str_split.h\"\n #include \"absl/strings/string_view.h\"\n+#include \"tensorflow/tsl/platform/errors.h\"\n #include \"tensorflow/tsl/platform/path.h\"\n+#include \"tensorflow/tsl/platform/statusor.h\"\n \n namespace tensorflow {\n namespace data {\n@@ -65,6 +70,28 @@ std::string SplitPath(absl::string_view snapshot_path, int64_t stream_index,\n       absl::StrCat(\"split_\", local_index, \"_\", global_index));\n }\n \n+tsl::StatusOr<std::pair<int64_t, int64_t>> SplitIndex(\n+    absl::string_view split_path) {\n+  std::vector<std::string> tokens = absl::StrSplit(split_path, '_');\n+  int64_t local_split_index = 0, global_split_index = 0;\n+  if (tokens.size() != 3 || tokens[0] != \"split\" ||\n+      !absl::SimpleAtoi(tokens[1], &local_split_index) ||\n+      local_split_index < 0 ||\n+      !absl::SimpleAtoi(tokens[2], &global_split_index) ||\n+      global_split_index < 0) {\n+    return tsl::errors::InvalidArgument(\n+        \"Invalid split file name: \", split_path,\n+        \". Expected split_<local_split_index>_<global_split_index>.\");\n+  }\n+  if (local_split_index > global_split_index) {\n+    return tsl::errors::InvalidArgument(\n+        \"Invalid split file name: \", split_path, \". The local split index \",\n+        local_split_index, \" exceeds the global split index \",\n+        global_split_index, \".\");\n+  }\n+  return std::make_pair(local_split_index, global_split_index);\n+}\n+\n std::string SnapshotMetadataFilePath(absl::string_view snapshot_path_) {\n   return tsl::io::JoinPath(snapshot_path_, kSnapshotMetadataFileName);\n }"