"diff --git a/tensorflow/core/data/service/snapshot/path_utils_test.cc b/tensorflow/core/data/service/snapshot/path_utils_test.cc\nindex e84c359d510..7bd27bbd85e 100644\n--- a/tensorflow/core/data/service/snapshot/path_utils_test.cc\n+++ b/tensorflow/core/data/service/snapshot/path_utils_test.cc\n@@ -14,13 +14,19 @@ limitations under the License.\n ==============================================================================*/\n #include \"tensorflow/core/data/service/snapshot/path_utils.h\"\n \n+#include \"tensorflow/tsl/platform/status_matchers.h\"\n #include \"tensorflow/tsl/platform/test.h\"\n+#include \"tensorflow/tsl/protobuf/error_codes.pb.h\"\n \n namespace tensorflow {\n namespace data {\n namespace {\n \n+using ::testing::HasSubstr;\n using ::testing::MatchesRegex;\n+using ::testing::Pair;\n+using tsl::testing::IsOkAndHolds;\n+using tsl::testing::StatusIs;\n \n TEST(PathUtilsTest, StreamsDirectory) {\n   EXPECT_THAT(StreamsDirectory(\"/path/to/snapshot\"),\n@@ -51,6 +57,34 @@ TEST(PathUtilsTest, SplitPath) {\n           \"/path/to/snapshot.streams.stream_0.splits.source_1.split_2_3\"));\n }\n \n+TEST(PathUtilsTest, SplitIndex) {\n+  EXPECT_THAT(SplitIndex(\"split_0_1\"), IsOkAndHolds(Pair(0, 1)));\n+}\n+\n+TEST(PathUtilsTest, InvalidSplitFile) {\n+  EXPECT_THAT(\n+      SplitIndex(\"\"),\n+      StatusIs(error::INVALID_ARGUMENT,\n+               HasSubstr(\n+                   \"Expected split_<local_split_index>_<global_split_index>\")));\n+  EXPECT_THAT(\n+      SplitIndex(\"split_123\"),\n+      StatusIs(error::INVALID_ARGUMENT,\n+               HasSubstr(\n+                   \"Expected split_<local_split_index>_<global_split_index>\")));\n+  EXPECT_THAT(\n+      SplitIndex(\"split_-1_(-1)\"),\n+      StatusIs(error::INVALID_ARGUMENT,\n+               HasSubstr(\n+                   \"Expected split_<local_split_index>_<global_split_index>\")));\n+  EXPECT_THAT(\n+      SplitIndex(\"split_5_0\"),\n+      StatusIs(\n+          error::INVALID_ARGUMENT,\n+          HasSubstr(\n+              \"The local split index 5 exceeds the global split index 0\")));\n+}\n+\n TEST(PathUtilsTest, StreamDoneFilePath) {\n   EXPECT_THAT(StreamDoneFilePath(\"/path/to/snapshot\", /*stream_index=*/0),\n               MatchesRegex(\"/path/to/snapshot.streams.stream_0.DONE\"));"