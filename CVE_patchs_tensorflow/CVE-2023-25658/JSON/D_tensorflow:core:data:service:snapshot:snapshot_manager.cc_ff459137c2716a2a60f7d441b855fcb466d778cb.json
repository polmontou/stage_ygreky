"diff --git a/tensorflow/core/data/service/snapshot/snapshot_manager.cc b/tensorflow/core/data/service/snapshot/snapshot_manager.cc\nindex 9fe47df0ee6..2f24c146485 100644\n--- a/tensorflow/core/data/service/snapshot/snapshot_manager.cc\n+++ b/tensorflow/core/data/service/snapshot/snapshot_manager.cc\n@@ -187,21 +187,8 @@ Status SnapshotManager::ReadOnDiskSource(\n \n     // `split_filename` must have this format:\n     // \"split_<local_split_index>_<global_split_index>\".\n-    std::vector<std::string> tokens = absl::StrSplit(split_filename, '_');\n-    int64_t local_split_index;\n-    int64_t global_split_index;\n-    if (tokens.size() != 3 ||\n-        !absl::SimpleAtoi(tokens[1], &local_split_index) ||\n-        local_split_index < 0 ||\n-        !absl::SimpleAtoi(tokens[2], &global_split_index) ||\n-        global_split_index < 0) {\n-      return InvalidArgument(\"can't parse the name of \", split_path);\n-    }\n-    if (local_split_index > global_split_index) {\n-      return InvalidArgument(\n-          \"found conflict between local split index and global split index in \",\n-          \"name of \", split_path);\n-    }\n+    TF_ASSIGN_OR_RETURN(auto split_index, SplitIndex(split_filename));\n+    auto [local_split_index, global_split_index] = split_index;\n     if (local_split_index > split_filenames.size() - 1) {\n       return InvalidArgument(\n           \"found conflict between the number of splits and name of \","