"diff --git a/tensorflow/core/kernels/data/iterator_ops.cc b/tensorflow/core/kernels/data/iterator_ops.cc\nindex 65f9367b740..0e0007ce8d6 100644\n--- a/tensorflow/core/kernels/data/iterator_ops.cc\n+++ b/tensorflow/core/kernels/data/iterator_ops.cc\n@@ -93,8 +93,6 @@ IteratorResource::IteratorResource(\n                                               /*iterator=*/nullptr)),\n       output_dtypes_(output_dtypes),\n       output_shapes_(output_shapes) {\n-  tf_dataz_metrics_collector_ = std::make_shared<TfDatazMetricsCollector>(*env);\n-  TfDatazMetricsRegistry::Register(tf_dataz_metrics_collector_);\n   VLOG(2) << \"creating iterator resource\";\n }\n \n@@ -274,6 +272,9 @@ Status IteratorResource::SetIteratorFromDataset(OpKernelContext* ctx,\n   new_state->MergeCheckpoint(iter_ctx.checkpoint());\n   mutex_lock l(mu_);\n   std::swap(iterator_state_, new_state);\n+  tf_dataz_metrics_collector_ =\n+      std::make_shared<TfDatazMetricsCollector>(env_, iterator.get());\n+  TfDatazMetricsRegistry::Register(tf_dataz_metrics_collector_);\n   return OkStatus();\n }\n "