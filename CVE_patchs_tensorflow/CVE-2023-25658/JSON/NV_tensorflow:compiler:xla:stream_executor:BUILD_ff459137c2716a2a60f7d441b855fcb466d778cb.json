"# GPU executor library for data-parallel kernel launches and cross-platform\n# HPC-library APIs.\n#\n# Throughout this file, all targets are built with the standard crosstool and\n# do not link against restricted binary blobs.\n\nload(\"//tensorflow/tsl/platform:build_config_root.bzl\", \"if_static\")\nload(\"//tensorflow/tsl:tsl.bzl\", \"transitive_hdrs\", \"tsl_gpu_library\")\nload(\"//tensorflow/tsl/platform:rules_cc.bzl\", \"cc_library\")\nload(\"//tensorflow/tsl/platform:build_config.bzl\", \"tf_proto_library\")\nload(\"//tensorflow/compiler/xla:xla.bzl\", \"xla_cc_test\")\nload(\"//tensorflow/compiler/xla/stream_executor:build_defs.bzl\", \"stream_executor_friends\")\nload(\"//tensorflow/tsl:tsl.default.bzl\", \"filegroup\")\n\npackage(\n    # copybara:uncomment default_applicable_licenses = [\"//tensorflow:license\"],\n    default_visibility = [\n        \":friends\",\n    ],\n    licenses = [\"notice\"],\n)\n\npackage_group(\n    name = \"friends\",\n    packages = stream_executor_friends(),\n)\n\n# The stream_executor_headers target does not prescribe an implementation.\ncc_library(\n    name = \"stream_executor_headers\",\n    textual_hdrs = [\n        \"blas.h\",\n        \"device_description.h\",\n        \"device_memory.h\",\n        \"device_memory_allocator.h\",\n        \"device_options.h\",\n        \"dnn.h\",\n        \"event.h\",\n        \"executor_cache.h\",\n        \"fft.h\",\n        \"gpu_launch_dim.h\",\n        \"kernel.h\",\n        \"kernel_cache_config.h\",\n        \"kernel_spec.h\",\n        \"launch_dim.h\",\n        \"module_spec.h\",\n        \"multi_platform_manager.h\",\n        \"platform.h\",\n        \"plugin.h\",\n        \"plugin_registry.h\",\n        \"rng.h\",\n        \"stream.h\",\n        \"stream_executor.h\",\n        \"stream_executor_internal.h\",\n        \"stream_executor_pimpl.h\",\n        \"temporary_device_memory.h\",\n        \"temporary_memory_manager.h\",\n        \"timer.h\",\n        \"trace_listener.h\",\n    ],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":allocator_stats\",\n        \":device_description_proto_cc\",\n        \":dnn_proto_cc\",\n        \":host_or_device_scalar\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:env\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/platform:types\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ntransitive_hdrs(\n    name = \"stream_executor_install_hdrs\",\n    deps = [\":stream_executor_headers\"],\n)\n\ncc_library(\n    name = \"launch_dim\",\n    hdrs = [\n        \"gpu_launch_dim.h\",\n        \"launch_dim.h\",\n    ],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"trace_listener\",\n    hdrs = [\n        \"trace_listener.h\",\n    ],\n    deps = [\n        \":device_memory\",\n        \":kernel\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_proto_library(\n    name = \"device_description_proto\",\n    srcs = [\"device_description.proto\"],\n    cc_api_version = 2,\n    make_default_target_header_only = True,\n    protodeps = [\n        \"//tensorflow/compiler/xla:autotune_results_proto\",\n    ],\n)\n\ncc_library(\n    name = \"device_description\",\n    srcs = [\"device_description.cc\"],\n    hdrs = [\"device_description.h\"],\n    deps = [\n        \":device_description_proto_cc\",\n        \":launch_dim\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/lib/math:math_util\",\n        \"//tensorflow/tsl/platform:numbers\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"kernel_spec\",\n    srcs = [\"kernel_spec.cc\"],\n    hdrs = [\"kernel_spec.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/synchronization\",\n    ],\n)\n\ncc_library(\n    name = \"kernel_cache_config\",\n    hdrs = [\"kernel_cache_config.h\"],\n)\n\ncc_library(\n    name = \"module_spec\",\n    hdrs = [\"module_spec.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"allocator_stats\",\n    srcs = [\n        \"allocator_stats.cc\",\n    ],\n    hdrs = [\"allocator_stats.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"data_type\",\n    hdrs = [\"data_type.h\"],\n    deps = [\n        \":dnn_proto_cc\",\n        \"//tensorflow/tsl/platform:float8\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n    ],\n)\n\ncc_library(\n    name = \"device_id_utils\",\n    hdrs = [\"device_id_utils.h\"],\n    deps = [\n        \":platform\",\n        \":stream_executor\",\n        \"//tensorflow/tsl/framework:device_id_impl\",\n        \"//tensorflow/tsl/lib/gtl:int_type\",\n        \"//tensorflow/tsl/platform:str_util\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"device_memory\",\n    hdrs = [\"device_memory.h\"],\n    deps = [\"//tensorflow/compiler/xla/stream_executor/platform\"],\n)\n\ncc_library(\n    name = \"device_options\",\n    hdrs = [\"device_options.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ntf_proto_library(\n    name = \"dnn_proto\",\n    srcs = [\"dnn.proto\"],\n    make_default_target_header_only = True,\n    protodeps = [\"//tensorflow/tsl/protobuf:dnn_proto\"],\n    exports = [\"//tensorflow/tsl/protobuf:dnn_proto\"],\n)\n\ncc_library(\n    name = \"fft\",\n    hdrs = [\"fft.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n    ],\n)\n\ncc_library(\n    name = \"platform\",\n    srcs = [\"platform.cc\"],\n    hdrs = [\"platform.h\"],\n    deps = [\n        \":plugin\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/strings\",\n    ],\n)\n\ncc_library(\n    name = \"plugin\",\n    srcs = [\"plugin.cc\"],\n    hdrs = [\"plugin.h\"],\n)\n\ncc_library(\n    name = \"rng\",\n    srcs = [\"rng.cc\"],\n    hdrs = [\"rng.h\"],\n    deps = [\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n    ],\n)\n\ncc_library(\n    name = \"device_mem_allocator\",\n    hdrs = [\n        \"device_host_allocator.h\",\n        \"device_mem_allocator.h\",\n    ],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":stream_executor\",\n        \"//tensorflow/tsl/framework:allocator\",\n        \"//tensorflow/tsl/framework:device_id\",\n        \"//tensorflow/tsl/platform:macros\",\n        \"//tensorflow/tsl/profiler/lib:traceme\",\n    ],\n)\n\nfilegroup(\n    name = \"device_mem_allocator_headers\",\n    srcs = [\n        \"device_host_allocator.h\",\n        \"device_mem_allocator.h\",\n    ],\n)\n\ncc_library(\n    name = \"executor_cache\",\n    srcs = [\n        \"device_description.h\",\n        \"device_memory.h\",\n        \"device_options.h\",\n        \"event.h\",\n        \"executor_cache.cc\",\n        \"launch_dim.h\",\n        \"plugin.h\",\n        \"plugin_registry.h\",\n        \"rng.h\",\n        \"stream_executor_pimpl.h\",\n        \"temporary_device_memory.h\",\n        \"temporary_memory_manager.h\",\n    ],\n    hdrs = [\n        \"blas.h\",\n        \"executor_cache.h\",\n        \"fft.h\",\n        \"kernel.h\",\n        \"kernel_cache_config.h\",\n        \"kernel_spec.h\",\n        \"platform.h\",\n        \"stream.h\",\n        \"stream_executor_internal.h\",\n        \"trace_listener.h\",\n    ],\n    deps = [\n        \":allocator_stats\",\n        \":data_type\",\n        \":device_description\",\n        \":device_description_proto_cc\",\n        \":device_memory\",\n        \":device_options\",\n        \":fft\",\n        \":kernel_cache_config\",\n        \":kernel_spec\",\n        \":launch_dim\",\n        \":plugin\",\n        \":rng\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:env\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"multi_platform_manager\",\n    srcs = [\"multi_platform_manager.cc\"],\n    hdrs = [\"multi_platform_manager.h\"],\n    deps = [\n        \":platform\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/synchronization\",\n    ],\n)\n\ncc_library(\n    name = \"stream_executor_internal\",\n    hdrs = [\n        \"stream_executor_internal.h\",\n    ],\n    deps = [\n        \":allocator_stats\",\n        \":device_description\",\n        \":device_memory\",\n        \":device_options\",\n        \":kernel\",\n        \":kernel_cache_config\",\n        \":kernel_spec\",\n        \":launch_dim\",\n        \":plugin_registry\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/types:optional\",\n    ],\n)\n\ncc_library(\n    name = \"stream_executor_pimpl_header\",\n    hdrs = [\n        \"device_description.h\",\n        \"kernel.h\",\n        \"kernel_cache_config.h\",\n        \"stream_executor_pimpl.h\",\n    ],\n    visibility = [\"//visibility:public\"],\n    deps = [\n        \":device_description\",\n        \":device_description_proto_cc\",\n        \":kernel_cache_config\",\n        \":platform\",\n        \":stream_executor_headers\",\n        \":stream_executor_internal\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:env\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\n# It implements :stream_executor_pimpl_header\ntsl_gpu_library(\n    name = \"stream_executor_pimpl\",\n    srcs = [\n        \"stream.cc\",\n        \"stream_executor_pimpl.cc\",\n    ],\n    hdrs = [\"stream_executor_pimpl.h\"],\n    deps = [\n        \":blas\",\n        \":device_memory\",\n        \":dnn\",\n        \":event\",\n        \":executor_cache\",\n        \":fft\",\n        \":host_or_device_scalar\",\n        \":kernel\",\n        \":launch_dim\",\n        \":platform\",\n        \":plugin_registry\",\n        \":rng\",\n        \":stream_executor_headers\",\n        \":stream_executor_internal\",\n        \":temporary_device_memory\",\n        \":temporary_memory_manager\",\n        \":timer\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:env\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:stacktrace\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"//tensorflow/tsl/util:env_var\",\n        \"//third_party/eigen3\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"kernel\",\n    srcs = [\n        \"fft.h\",\n        \"kernel.cc\",\n        \"plugin.h\",\n        \"rng.h\",\n        \"stream.h\",\n        \"stream_executor_pimpl.h\",\n        \"temporary_device_memory.h\",\n        \"temporary_memory_manager.h\",\n    ],\n    hdrs = [\n        \"blas.h\",\n        \"device_description.h\",\n        \"device_options.h\",\n        \"event.h\",\n        \"kernel.h\",\n        \"kernel_spec.h\",\n        \"launch_dim.h\",\n        \"multi_platform_manager.h\",\n        \"platform.h\",\n        \"plugin_registry.h\",\n        \"stream_executor.h\",\n        \"stream_executor_internal.h\",\n        \"timer.h\",\n        \"trace_listener.h\",\n    ],\n    deps = [\n        \":allocator_stats\",\n        \":data_type\",\n        \":device_description\",\n        \":device_description_proto_cc\",\n        \":device_memory\",\n        \":device_options\",\n        \":fft\",\n        \":kernel_cache_config\",\n        \":kernel_spec\",\n        \":launch_dim\",\n        \":platform\",\n        \":plugin\",\n        \":plugin_registry\",\n        \":rng\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:env\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:platform_port\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"timer\",\n    srcs = [\n        \"device_description.h\",\n        \"kernel_cache_config.h\",\n        \"timer.cc\",\n    ],\n    hdrs = [\n        \"blas.h\",\n        \"kernel.h\",\n        \"stream.h\",\n        \"stream_executor.h\",\n        \"timer.h\",\n    ],\n    deps = [\n        \":data_type\",\n        \":device_description\",\n        \":device_description_proto_cc\",\n        \":kernel_cache_config\",\n        \":platform\",\n        \":stream_executor_headers\",\n        \":stream_executor_pimpl_header\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"blas\",\n    srcs = [\"blas.cc\"],\n    hdrs = [\"blas.h\"],\n    deps = [\n        \":data_type\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"host_or_device_scalar\",\n    hdrs = [\"host_or_device_scalar.h\"],\n    deps = [\n        \":data_type\",\n        \":device_memory\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n    ],\n)\n\ncc_library(\n    name = \"event\",\n    srcs = [\n        \"blas.h\",\n        \"device_description.h\",\n        \"device_options.h\",\n        \"event.cc\",\n        \"fft.h\",\n        \"kernel_cache_config.h\",\n        \"launch_dim.h\",\n        \"plugin.h\",\n        \"plugin_registry.h\",\n        \"rng.h\",\n        \"stream_executor_pimpl.h\",\n        \"temporary_device_memory.h\",\n        \"temporary_memory_manager.h\",\n        \"trace_listener.h\",\n    ],\n    hdrs = [\n        \"device_memory.h\",\n        \"event.h\",\n        \"kernel.h\",\n        \"kernel_spec.h\",\n        \"platform.h\",\n        \"stream.h\",\n        \"stream_executor_internal.h\",\n    ],\n    deps = [\n        \":allocator_stats\",\n        \":blas\",\n        \":data_type\",\n        \":device_description\",\n        \":device_description_proto_cc\",\n        \":device_memory\",\n        \":device_options\",\n        \":fft\",\n        \":kernel_cache_config\",\n        \":kernel_spec\",\n        \":launch_dim\",\n        \":platform\",\n        \":plugin\",\n        \":rng\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:env\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/functional:any_invocable\",\n        \"@com_google_absl//absl/memory\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"plugin_registry\",\n    srcs = [\"plugin_registry.cc\"],\n    hdrs = [\"plugin_registry.h\"],\n    deps = [\n        \":blas\",\n        \":dnn\",\n        \":fft\",\n        \":multi_platform_manager\",\n        \":platform\",\n        \":plugin\",\n        \":stream_executor_headers\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/synchronization\",\n    ],\n)\n\ncc_library(\n    name = \"dnn\",\n    srcs = [\"dnn.cc\"],\n    hdrs = [\"dnn.h\"],\n    deps = [\n        \":data_type\",\n        \":device_description_proto_cc\",\n        \":device_memory\",\n        \":dnn_proto_cc\",\n        \":stream_executor_headers\",\n        \"@com_google_absl//absl/algorithm:container\",\n        \"@com_google_absl//absl/container:btree\",\n        \"@com_google_absl//absl/container:flat_hash_map\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/types:optional\",\n        \"@com_google_absl//absl/types:span\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/lib/strings:proto_serialization\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc\",\n    ] + if_static([\"@com_google_protobuf//:protobuf\"]),\n)\n\ncc_library(\n    name = \"temporary_memory_manager\",\n    srcs = [\"temporary_memory_manager.cc\"],\n    hdrs = [\"temporary_memory_manager.h\"],\n    deps = [\n        \":device_memory\",\n        \":stream_executor_headers\",\n        \":stream_executor_pimpl_header\",\n        \":temporary_device_memory\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/strings\",\n        \"@com_google_absl//absl/strings:str_format\",\n        \"@com_google_absl//absl/synchronization\",\n    ],\n)\n\ncc_library(\n    name = \"temporary_device_memory\",\n    srcs = [\n        \"event.h\",\n        \"temporary_device_memory.cc\",\n        \"temporary_memory_manager.h\",\n    ],\n    hdrs = [\"temporary_device_memory.h\"],\n    deps = [\n        \":device_memory\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/synchronization\",\n    ],\n)\n\ncc_library(\n    name = \"stream_executor\",\n    textual_hdrs = [\n        \"blas.h\",\n        \"device_description.h\",\n        \"device_memory.h\",\n        \"device_memory_allocator.h\",\n        \"device_options.h\",\n        \"dnn.h\",\n        \"event.h\",\n        \"executor_cache.h\",\n        \"fft.h\",\n        \"gpu_launch_dim.h\",\n        \"kernel.h\",\n        \"kernel_cache_config.h\",\n        \"kernel_spec.h\",\n        \"launch_dim.h\",\n        \"module_spec.h\",\n        \"multi_platform_manager.h\",\n        \"platform.h\",\n        \"plugin.h\",\n        \"plugin_registry.h\",\n        \"rng.h\",\n        \"stream.h\",\n        \"stream_executor.h\",\n        \"stream_executor_internal.h\",\n        \"stream_executor_pimpl.h\",\n        \"temporary_device_memory.h\",\n        \"temporary_memory_manager.h\",\n        \"timer.h\",\n        \"trace_listener.h\",\n    ],\n    deps = [\n        \":stream_executor_headers\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:logging\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:types\",\n    ] + if_static([\":stream_executor_impl\"]),\n)\n\ncc_library(\n    name = \"stream_executor_impl\",\n    deps = [\n        \":device_description\",\n        \":device_memory\",\n        \":dnn_proto_cc\",\n        \":event\",\n        \":kernel\",\n        \":launch_dim\",\n        \":multi_platform_manager\",\n        \":platform\",\n        \":stream_executor_headers\",\n        \":stream_executor_pimpl\",\n        \":timer\",\n        \"//tensorflow/compiler/xla/stream_executor:dnn_proto_cc_impl\",\n        \"//tensorflow/tsl/protobuf:dnn_proto_cc_impl\",\n    ],\n)\n\ncc_library(\n    name = \"device_memory_allocator\",\n    hdrs = [\"device_memory_allocator.h\"],\n    deps = [\n        \":device_memory\",\n        \":platform\",\n        \":stream_executor\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:status\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"//tensorflow/tsl/platform:types\",\n        \"@com_google_absl//absl/base:core_headers\",\n        \"@com_google_absl//absl/synchronization\",\n        \"@com_google_absl//absl/types:span\",\n    ],\n)\n\ncc_library(\n    name = \"scratch_allocator\",\n    srcs = [\"scratch_allocator.cc\"],\n    hdrs = [\"scratch_allocator.h\"],\n    deps = [\n        \":device_memory\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/platform\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/container:inlined_vector\",\n    ],\n)\n\nxla_cc_test(\n    name = \"stream_test\",\n    size = \"small\",\n    srcs = [\"stream_test.cc\"],\n    deps = [\n        \":stream_executor\",\n        \"//tensorflow/compiler/xla/stream_executor/host:host_platform\",\n        \"//tensorflow/tsl/platform:test\",\n        \"//tensorflow/tsl/platform:test_main\",\n    ],\n)\n\nxla_cc_test(\n    name = \"dnn_test\",\n    size = \"small\",\n    srcs = [\"dnn_test.cc\"],\n    deps = [\n        \":dnn\",\n        \"//tensorflow/tsl/platform:test\",\n        \"//tensorflow/tsl/platform:test_main\",\n    ],\n)\n\ncc_library(\n    name = \"tf_allocator_adapter\",\n    srcs = [\"tf_allocator_adapter.cc\"],\n    hdrs = [\"tf_allocator_adapter.h\"],\n    deps = [\n        \":device_memory\",\n        \":device_memory_allocator\",\n        \":platform\",\n        \":stream_executor_headers\",\n        \"//tensorflow/compiler/xla/stream_executor/lib\",\n        \"//tensorflow/tsl/framework:allocator\",\n        \"//tensorflow/tsl/platform:errors\",\n        \"//tensorflow/tsl/platform:statusor\",\n        \"@com_google_absl//absl/synchronization\",\n    ],\n)\n\ncc_library(\n    name = \"lazy_op_runner\",\n    hdrs = [\"lazy_op_runner.h\"],\n    deps = [\n        \":dnn\",\n        \":stream_executor_headers\",\n        \"@com_google_absl//absl/base\",\n    ],\n)\n\nexports_files([\"lazy_op_runner.h\"])\n\nalias(\n    name = \"cuda_platform\",\n    actual = \"//tensorflow/compiler/xla/stream_executor/cuda:all_runtime\",\n)\n\nalias(\n    name = \"rocm_platform\",\n    actual = \"//tensorflow/compiler/xla/stream_executor/rocm:all_runtime\",\n)\n\n# TODO(se-owner): document or remove this.\ncc_library(\n    name = \"stream_executor_bundle\",\n    deps = [\n        \":dnn\",\n        \":event\",\n        \":multi_platform_manager\",\n        \":scratch_allocator\",\n        \":stream_executor\",\n        \"//tensorflow/compiler/xla/stream_executor/cuda:cuda_platform_id\",\n        \"//tensorflow/compiler/xla/stream_executor/host:host_platform\",\n        \"//tensorflow/compiler/xla/stream_executor/host:host_platform_id\",\n        \"//tensorflow/compiler/xla/stream_executor/platform:dso_loader\",\n        \"//tensorflow/compiler/xla/stream_executor/rocm:rocm_platform_id\",\n    ],\n)"