"diff --git a/tensorflow/core/ops/array_ops.cc b/tensorflow/core/ops/array_ops.cc\nindex 13e24aa503d..ef23f456533 100644\n--- a/tensorflow/core/ops/array_ops.cc\n+++ b/tensorflow/core/ops/array_ops.cc\n@@ -25,6 +25,7 @@ limitations under the License.\n #include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n+#include \"tensorflow/core/platform/status.h\"\n #include \"tensorflow/core/platform/types.h\"\n #include \"tensorflow/core/util/mirror_pad_mode.h\"\n #include \"tensorflow/core/util/padding.h\"\n@@ -1072,13 +1073,24 @@ REGISTER_OP(\"EditDistance\")\n         // or else the output shape is unknown.\n         return shape_inference::UnknownShape(c);\n       }\n-\n       if (hypothesis_shape_t->NumElements() != truth_shape_t->NumElements()) {\n         return errors::InvalidArgument(\n             \"Num elements of hypothesis_shape does not match truth_shape: \",\n             hypothesis_shape_t->NumElements(), \" vs. \",\n             truth_shape_t->NumElements());\n       }\n+      if (hypothesis_shape_t->NumElements() < 2) {\n+        return errors::InvalidArgument(\n+            \"Input Hypothesis SparseTensors must have rank at least 2, but \"\n+            \"hypothesis_shape rank is: \",\n+            hypothesis_shape_t->NumElements());\n+      }\n+      if (truth_shape_t->NumElements() < 2) {\n+        return errors::InvalidArgument(\n+            \"Input Truth SparseTensors must have rank at least 2, but \"\n+            \"truth_shape rank is: \",\n+            truth_shape_t->NumElements());\n+      }\n \n       auto h_values = hypothesis_shape_t->flat<int64_t>();\n       auto t_values = truth_shape_t->flat<int64_t>();"