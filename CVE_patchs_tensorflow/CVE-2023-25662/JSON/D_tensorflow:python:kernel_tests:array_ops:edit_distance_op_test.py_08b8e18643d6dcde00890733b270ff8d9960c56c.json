"diff --git a/tensorflow/python/kernel_tests/array_ops/edit_distance_op_test.py b/tensorflow/python/kernel_tests/array_ops/edit_distance_op_test.py\nindex 8aa22cb812a..3dc2f4565b7 100644\n--- a/tensorflow/python/kernel_tests/array_ops/edit_distance_op_test.py\n+++ b/tensorflow/python/kernel_tests/array_ops/edit_distance_op_test.py\n@@ -15,8 +15,9 @@\n \"\"\"Tests for tensorflow.kernels.edit_distance_op.\"\"\"\n \n import numpy as np\n-\n+from tensorflow.python.eager import def_function\n from tensorflow.python.framework import constant_op\n+from tensorflow.python.framework import errors\n from tensorflow.python.framework import ops\n from tensorflow.python.framework import sparse_tensor\n from tensorflow.python.ops import array_ops\n@@ -225,6 +226,66 @@ class EditDistanceTest(test.TestCase):\n                          \"to outside of the buffer for the output tensor|\"\n                          r\"Dimension -\\d+ must be >= 0\"))\n \n+  def testEmptyShapeWithEditDistanceRaisesError(self):\n+    para = {\n+        \"hypothesis_indices\": [[]],\n+        \"hypothesis_values\": [\"tmp/\"],\n+        \"hypothesis_shape\": [],\n+        \"truth_indices\": [[]],\n+        \"truth_values\": [\"\"],\n+        \"truth_shape\": [],\n+        \"normalize\": False,\n+    }\n+\n+    # Check edit distance raw op with empty shape in eager mode.\n+    with self.assertRaisesRegex(\n+        (errors.InvalidArgumentError, ValueError),\n+        (\n+            r\"Input Hypothesis SparseTensors must have rank at least 2, but\"\n+            \" hypothesis_shape rank is: 0|Input SparseTensors must have rank \"\n+            \"at least 2, but truth_shape rank is: 0\"\n+        ),\n+    ):\n+      array_ops.gen_array_ops.EditDistance(**para)\n+\n+    # Check raw op with tf.function\n+    @def_function.function\n+    def TestFunction():\n+      \"\"\"Wrapper function for edit distance call.\"\"\"\n+      array_ops.gen_array_ops.EditDistance(**para)\n+\n+    with self.assertRaisesRegex(\n+        ValueError,\n+        (\n+            \"Input Hypothesis SparseTensors must have rank at least 2, but\"\n+            \" hypothesis_shape rank is: 0\"\n+        ),\n+    ):\n+      TestFunction()\n+\n+    # Check with python wrapper API\n+    hypothesis_indices = [[]]\n+    hypothesis_values = [0]\n+    hypothesis_shape = []\n+    truth_indices = [[]]\n+    truth_values = [1]\n+    truth_shape = []\n+    expected_output = []  # dummy ignored\n+\n+    with self.assertRaisesRegex(\n+        ValueError,\n+        (\n+            \"Input Hypothesis SparseTensors must have rank at least 2, but\"\n+            \" hypothesis_shape rank is: 0\"\n+        ),\n+    ):\n+      self._testEditDistance(\n+          hypothesis=(hypothesis_indices, hypothesis_values, hypothesis_shape),\n+          truth=(truth_indices, truth_values, truth_shape),\n+          normalize=False,\n+          expected_output=expected_output,\n+      )\n+\n \n if __name__ == \"__main__\":\n   test.main()"