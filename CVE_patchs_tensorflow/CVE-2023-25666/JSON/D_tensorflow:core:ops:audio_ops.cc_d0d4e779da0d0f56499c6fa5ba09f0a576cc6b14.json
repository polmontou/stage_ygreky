"diff --git a/tensorflow/core/ops/audio_ops.cc b/tensorflow/core/ops/audio_ops.cc\nindex 807cd6d9b48..240567c5307 100644\n--- a/tensorflow/core/ops/audio_ops.cc\n+++ b/tensorflow/core/ops/audio_ops.cc\n@@ -17,6 +17,7 @@ limitations under the License.\n #include \"tensorflow/core/framework/op.h\"\n #include \"tensorflow/core/framework/shape_inference.h\"\n #include \"tensorflow/core/lib/core/bits.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n \n@@ -72,8 +73,17 @@ Status SpectrogramShapeFn(InferenceContext* c) {\n   TF_RETURN_IF_ERROR(c->WithRank(c->input(0), 2, &input));\n   int32_t window_size;\n   TF_RETURN_IF_ERROR(c->GetAttr(\"window_size\", &window_size));\n+  if (window_size <= 1) {\n+    return errors::InvalidArgument(\"window size must be > 1, got \",\n+                                   window_size);\n+  }\n+\n   int32_t stride;\n   TF_RETURN_IF_ERROR(c->GetAttr(\"stride\", &stride));\n+  if (stride <= 0) {\n+    return errors::InvalidArgument(\"stride must be strictly positive, got \",\n+                                   stride);\n+  }\n \n   DimensionHandle input_length = c->Dim(input, 0);\n   DimensionHandle input_channels = c->Dim(input, 1);"