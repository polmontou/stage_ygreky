"diff --git a/tensorflow/compiler/tf2xla/kernels/bincount_op.cc b/tensorflow/compiler/tf2xla/kernels/bincount_op.cc\nindex ba95c77f612..5cac4d98c50 100644\n--- a/tensorflow/compiler/tf2xla/kernels/bincount_op.cc\n+++ b/tensorflow/compiler/tf2xla/kernels/bincount_op.cc\n@@ -62,21 +62,15 @@ class DenseBincountOp : public XlaOpKernel {\n     StatusOr<xla::Shape> input_shape_or = ctx->builder()->GetShape(input);\n     OP_REQUIRES_OK(ctx, input_shape_or.status());\n     auto input_shape = input_shape_or.value();\n-    auto size = input_shape.dimensions(0);\n \n-    if (!size) {\n-      output = xla::Broadcast(zero, {output_size});\n-      ctx->SetOutput(0, output);\n-      return;\n-    }\n     auto rank = input_shape.rank();\n \n     OP_REQUIRES(ctx, rank <= 2,\n                 errors::InvalidArgument(\n                     \"Shape must be at most rank 2 but is rank \", rank));\n-\n     xla::XlaOp weights = ctx->Input(2);\n     StatusOr<xla::Shape> weights_shape_or = ctx->builder()->GetShape(weights);\n+\n     OP_REQUIRES_OK(ctx, weights_shape_or.status());\n \n     auto weights_shape = weights_shape_or.value();\n@@ -91,11 +85,20 @@ class DenseBincountOp : public XlaOpKernel {\n                     \"1. Received \",\n                     weights_shape.DebugString()));\n \n+    auto size = input_shape.dimensions(0);\n+\n+    if (!size) {\n+      output = xla::Broadcast(zero, {output_size});\n+      ctx->SetOutput(0, output);\n+      return;\n+    }\n+\n     auto weights_size = weights_shape.dimensions(0);\n     bool has_weights = false;\n     if (weights_size) {\n       has_weights = true;\n     }\n+\n     xla::Shape output_shape = xla::ShapeUtil::MakeShape(dtype, {output_size});\n     xla::ScatterDimensionNumbers scatter_dnums;\n     scatter_dnums.set_index_vector_dim(1);"